# 開発ガイドライン

> **ARCHIVE_CANDIDATE**: 雑談対応や型運用などMVPで未対応の指針をまとめています。MVP期間中は参考情報として残します。

このファイルは、GameChat AI開発時のガイドラインを統合したものです。

## 🗣️ 雑談対応ガイドライン

AIチャットボットのユーザー体験向上を目的として、雑談（あいさつ・軽い話題等）への対応方針を明確化します。

### 対応基準

| 内容                           | 許容すべき？ | 理由                                                         |
|-------------------------------|:------------:|--------------------------------------------------------------|
| **あいさつ（例：おはよう）**        | ✅           | 雑談の基本。無視・否定は印象が悪い                           |
| **質問以外の軽い話題（例：今日の調子は？）** | ✅           | 信頼関係構築に寄与                                           |
| **ゲームにやや関係ある話題（例：このカードって人気あるの？）** | ⚠️           | ゲームに関連する場合は簡潔に返答し、本題に誘導               |
| **明らかにゲーム外の質問（例：天気、ニュース）** | 🚫           | 「ゲームに関係ない話題なので、お答えできません」と軽くいなす |
| **不適切な内容（攻撃的・倫理的に問題）**      | 🚫           | フィルタリングが必要                                         |

### 実装方針

#### プロンプト設計
LLMの`system_prompt`に以下の指示を追加：
- ユーザーがあいさつや軽い雑談をした場合は、簡潔でフレンドリーに返答してください。
- ユーザーの質問がゲームに無関係な話題（例：天気、政治）である場合、「ゲームに関係のある話題に限定しています」と返答してください。
- 不適切、攻撃的、差別的な内容には返答せず、警告してください。
- 雑談と本題が混在する場合は、雑談に短く返しつつ本題に移行してください。

#### 入力フィルタリング
- ユーザー入力を解析し、不適切な内容（攻撃的・倫理的に問題のある表現）を検出してブロック。

#### 雑談からゲーム話題への誘導
```python
# 例: 雑談検出後の誘導例
if is_casual_talk(user_input):
    return generate_response(
        casual_response=get_casual_response(user_input),
        game_prompt="何かゲームについて質問があれば、お気軽にどうぞ！"
    )
```

---

## 🔤 型ガイドライン

プロジェクト全体で型定義の一貫性・再利用性・保守性を高めるための運用ルールです。

### 型定義の共通化
- 共通で利用する型は `src/types/` 配下に集約し、各機能・画面でimportして利用する
- 画面・機能固有の型は各ディレクトリ直下の`types.ts`等に定義し、必要に応じて共通型へ昇格

### 命名規則
- Props型は`[Component名]Props`とする（例: `ChatInputProps`）
- 配列は複数形、単体は単数形で命名
- Union型・Enum型は`[対象名]Type`や`[対象名]Enum`とする

### 型の拡張・再利用
- 共通型をextends/Partial/Pick等で拡張し、重複を避ける
- 型の重複定義は禁止。既存型を流用・拡張する

### any禁止・strict化
- `any`の利用は禁止。どうしても必要な場合は理由をコメントで明記
- `strict`モードを維持し、型エラーは必ず修正

### import経路
- 共通型は`src/types/xxx`からimportし、相対パスの深さを最小化
- テスト・Storybook等も同様に共通型をimport

### ドキュメント運用
- 型定義・ガイドラインはこのファイルで管理し、随時アップデート
- 型追加・変更時は必ず本ガイドラインも見直す

---

## 🔒 セキュリティ開発方針

### コード実装
- APIキーや機密情報は環境変数で管理
- ユーザー入力は必ずサニタイズ・バリデーション
- ログ出力時は機密情報をマスキング

### テスト
- セキュリティテストを必須とする
- 認証・認可のテストケースを充実
- 入力値検証のエッジケーステスト

---

## 📝 コードレビュー方針

### 必須チェック項目
- [ ] 型安全性の確保（anyゼロ、strictモード準拠）
- [ ] セキュリティ考慮事項の確認
- [ ] パフォーマンスへの影響評価
- [ ] テストカバレッジの確認

### 推奨チェック項目
- [ ] 雑談対応ガイドラインの反映
- [ ] エラーハンドリングの適切性
- [ ] ドキュメントの更新
