# gamechat-ai - AIãƒãƒ£ãƒƒãƒˆå‹ã‚²ãƒ¼ãƒ æ”»ç•¥ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ

ã‚²ãƒ¼ãƒ æ”»ç•¥æƒ…å ±ã‚’æ´»ç”¨ã—ã€ãƒãƒ£ãƒƒãƒˆå½¢å¼ã§è³ªå•ã«ç­”ãˆã‚‹AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã§ã™ã€‚  
RAGï¼ˆæ¤œç´¢æ‹¡å¼µç”Ÿæˆï¼‰æŠ€è¡“ã‚’ç”¨ã„ã¦ã€æ”»ç•¥Wikiã‚„å…¬å¼ã‚¬ã‚¤ãƒ‰ãªã©ã®æƒ…å ±ã‚’æ–‡è„ˆã«æ²¿ã£ã¦æä¾›ã—ã¾ã™ã€‚

---

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
- Next.js (React + TypeScript)
- Tailwind CSS

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
- Python + FastAPI
- Firebase Functionsï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

### AIãƒ»æ¤œç´¢é–¢é€£
- OpenAI API (ChatGPT, Embedding)
- Upstash Vectorï¼ˆãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ã‚µãƒ¼ãƒ“ã‚¹ï¼Dense Indexå¯¾å¿œï¼‰
- **ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ ï¼ˆæœ€é©åŒ–å¯¾å¿œï¼‰**
  - **æ¤œç´¢ãƒ•ãƒ­ãƒ¼**: æŒ¨æ‹¶æ¤œå‡º â†’ LLMåˆ†é¡ãƒ»è¦ç´„ â†’ æ¤œç´¢æˆ¦ç•¥é¸æŠ â†’ çµæœçµ±åˆ â†’ å¿œç­”ç”Ÿæˆ
  - **LLMåˆ†é¡**: ã‚¯ã‚¨ãƒªã‚¿ã‚¤ãƒ—åˆ¤å®šï¼ˆfilterable/semantic/hybrid/greetingï¼‰
  - **æ§‹é€ åŒ–æ¤œç´¢**: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¤œç´¢ï¼ˆHPæ¡ä»¶ã€ã‚«ãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼‰
  - **ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯æ¤œç´¢**: ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ã«ã‚ˆã‚‹æ„å‘³çš„é¡ä¼¼åº¦æ¤œç´¢
  - **çµ±åˆæˆ¦ç•¥**: 3ã¤ã®ãƒãƒ¼ã‚¸æˆ¦ç•¥ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ–ãƒ«å„ªå…ˆã€ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯å„ªå…ˆã€é‡ã¿ä»˜ããƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ï¼‰
  - **åˆ†é¡ãƒ™ãƒ¼ã‚¹æ¤œç´¢æœ€é©åŒ–ã‚·ã‚¹ãƒ†ãƒ **
    - åˆ†é¡ã‚¿ã‚¤ãƒ—åˆ¥ã®å‹•çš„é–¾å€¤ãƒ»ä»¶æ•°èª¿æ•´ï¼ˆsemantic: 0.75, hybrid: 0.70, filterable: 0.65ï¼‰
    - ä¿¡é ¼åº¦ã«ã‚ˆã‚‹æ®µéšçš„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´ï¼ˆé«˜/ä¸­/ä½ä¿¡é ¼åº¦åˆ¥ã®æœ€é©åŒ–ï¼‰
    - ãƒãƒ¼ãƒ ã‚¹ãƒšãƒ¼ã‚¹å„ªå…ˆé †ä½æœ€é©åŒ–ï¼ˆåˆ†é¡ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸæ¤œç´¢å¯¾è±¡èª¿æ•´ï¼‰
    - æ¤œç´¢å“è³ªè©•ä¾¡ãƒ»é©å¿œçš„ãƒãƒ¼ã‚¸ã‚·ã‚¹ãƒ†ãƒ 
    - é«˜åº¦ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ»ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æˆ¦ç•¥
  - **æŒ¨æ‹¶æ¤œå‡ºãƒ»æ—©æœŸå¿œç­”ã‚·ã‚¹ãƒ†ãƒ ï¼ˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ï¼‰**
    - æŒ¨æ‹¶ã‚¯ã‚¨ãƒªã®è‡ªå‹•æ¤œå‡ºã¨ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ã‚¹ã‚­ãƒƒãƒ—
    - **87%ã®å¿œç­”æ™‚é–“çŸ­ç¸®**ï¼ˆ14.8ç§’â†’1.8ç§’ï¼‰
    - 100%ã®æŒ¨æ‹¶æ¤œå‡ºç²¾åº¦é”æˆ
    - ã‚²ãƒ¼ãƒ ã‚«ãƒ¼ãƒ‰é–¢é€£ã®è‡ªç„¶ãªå®šå‹å¿œç­”
  - **LLMåˆ†é¡ã«åŸºã¥ãåŸ‹ã‚è¾¼ã¿æœ€é©åŒ–ã‚·ã‚¹ãƒ†ãƒ **
    - ä¿¡é ¼åº¦ã«ã‚ˆã‚‹æ®µéšçš„ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æˆ¦ç•¥ï¼ˆé«˜ä¿¡é ¼åº¦ï¼šè¦ç´„ä½¿ç”¨ã€ä¸­ä¿¡é ¼åº¦ï¼šã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ´»ç”¨ã€ä½ä¿¡é ¼åº¦ï¼šå…ƒè³ªå•ä½¿ç”¨ï¼‰
    - è¦ç´„ãƒ»ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æƒ…å ±ã‚’æ´»ç”¨ã—ãŸåŸ‹ã‚è¾¼ã¿ç”Ÿæˆï¼ˆæ¤œç´¢ç²¾åº¦å‘ä¸Šï¼‰
    - ã‚²ãƒ¼ãƒ ã‚«ãƒ¼ãƒ‰ç‰¹åŒ–ã®å“è³ªè©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ ï¼ˆé‡è¦ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ä¿æŒç¢ºèªï¼‰
- **LLMå¿œç­”ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ ï¼ˆå“è³ªæœ€é©åŒ–ï¼‰**
  - æ¤œç´¢çµæœã¨å…ƒè³ªå•ã®çµ±åˆå‡¦ç†
  - ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå“è³ªã«åŸºã¥ãå‹•çš„å¿œç­”æˆ¦ç•¥
  - ç°¡æ½”ã§å®Ÿç”¨çš„ãªå›ç­”ç”Ÿæˆï¼ˆ100-200æ–‡å­—æœ€é©åŒ–ï¼‰
  - é–¢é€£åº¦ã‚¹ã‚³ã‚¢ã«ã‚ˆã‚‹è©³ç´°åº¦è‡ªå‹•èª¿æ•´
- Pythonï¼ˆãƒ‡ãƒ¼ã‚¿åŸ‹ã‚è¾¼ã¿ãƒ»ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼‰

### ã‚¤ãƒ³ãƒ•ãƒ©ãƒ»ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°
- **Google Cloud Run**ï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIï¼‰
  - ã‚µãƒ¼ãƒ“ã‚¹å: `gamechat-ai-backend`
  - ãƒªãƒ¼ã‚¸ãƒ§ãƒ³: `asia-northeast1`ï¼ˆæ±äº¬ï¼‰
  - URL: `https://gamechat-ai-backend-507618950161.asia-northeast1.run.app`
  - ã‚¹ãƒšãƒƒã‚¯: CPU 1ã‚³ã‚¢ã€ãƒ¡ãƒ¢ãƒª 1GB
  - è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°: 0-10ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
  - ã‚³ãƒ³ãƒ†ãƒŠ: Dockerï¼ˆlinux/amd64ï¼‰
- **Firebase Hosting**ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰
  - é™çš„ã‚µã‚¤ãƒˆãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°
  - Cloud Runãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¨ã®è‡ªå‹•é€£æº
  - ã‚°ãƒ­ãƒ¼ãƒãƒ«CDNé…ä¿¡
  - è‡ªå‹•HTTPSåŒ–
- Firebase Firestore / Upstash Vectorï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼‰
- AWS Lambda / Firebase Functionsï¼ˆã‚µãƒ¼ãƒãƒ¬ã‚¹APIï¼‰
- **Artifact Registry**ï¼ˆDockerã‚¤ãƒ¡ãƒ¼ã‚¸ç®¡ç†ï¼‰
  - ã‚¤ãƒ¡ãƒ¼ã‚¸: `asia-northeast1-docker.pkg.dev/gamechat-ai/gamechat-ai-backend/backend`
- Dockerï¼ˆãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒï¼‰
  - Alpine Linux ãƒ™ãƒ¼ã‚¹ã®è»½é‡ã‚¤ãƒ¡ãƒ¼ã‚¸
  - ãƒãƒ«ãƒã‚¹ãƒ†ãƒ¼ã‚¸ãƒ“ãƒ«ãƒ‰ã«ã‚ˆã‚‹æœ€é©åŒ–
  - é–‹ç™ºç”¨ãƒ»æœ¬ç•ªç”¨Dockerfileåˆ†é›¢

---

## ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ 

### æ¦‚è¦
æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€LLMã«ã‚ˆã‚‹ã‚¯ã‚¨ãƒªåˆ†é¡ã¨æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¤œç´¢ã€ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ã‚’çµ„ã¿åˆã‚ã›ãŸãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚

### ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ãƒ•ãƒ­ãƒ¼å›³

```mermaid
graph TD
    A[ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›] --> B[æŒ¨æ‹¶æ¤œå‡º]
    B -->|æŒ¨æ‹¶ã§ã‚ã‚‹| C[å®šå‹å¿œç­”ç”Ÿæˆ]
    B -->|æŒ¨æ‹¶ã§ãªã„| D[LLMåˆ†é¡ãƒ»è¦ç´„]
    
    D --> E{åˆ†é¡çµæœ}
    E -->|FILTERABLE| F[æ§‹é€ åŒ–DBæ¤œç´¢]
    E -->|SEMANTIC| G[ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢]
    E -->|HYBRID| H[DBæ¤œç´¢ + ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢]
    
    F --> I[çµæœãƒãƒ¼ã‚¸ãƒ»çµ±åˆ]
    G --> I
    H --> I
    
    I --> J[ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå“è³ªè©•ä¾¡]
    J --> K[LLMå¿œç­”ç”Ÿæˆ]
    K --> L[æœ€çµ‚å›ç­”]
    C --> L
    
    style B fill:#e1f5fe
    style D fill:#f3e5f5
    style F fill:#e8f5e8
    style G fill:#fff3e0
    style H fill:#fce4ec
    style K fill:#f1f8e9
```

### æ¤œç´¢ãƒ•ãƒ­ãƒ¼ã®è©³ç´°èª¬æ˜

#### 1. **æŒ¨æ‹¶æ¤œå‡ºãƒ•ã‚§ãƒ¼ã‚º**
- **ç›®çš„**: ä¸è¦ãªæ¤œç´¢å‡¦ç†ã‚’å›é¿ã—ã€å³åº§ã«è‡ªç„¶ãªå¿œç­”ã‚’æä¾›
- **å‡¦ç†**: æ­£è¦è¡¨ç¾ã¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒãƒãƒ³ã‚°ã«ã‚ˆã‚‹é«˜é€Ÿåˆ¤å®š
- **åŠ¹æœ**: 87%ã®å¿œç­”æ™‚é–“çŸ­ç¸®ï¼ˆ14.8ç§’â†’1.8ç§’ï¼‰

#### 2. **LLMåˆ†é¡ãƒ»è¦ç´„ãƒ•ã‚§ãƒ¼ã‚º**
- **ç›®çš„**: ã‚¯ã‚¨ãƒªã‚’4ã¤ã®ã‚¿ã‚¤ãƒ—ã«åˆ†é¡ã—ã€æœ€é©ãªæ¤œç´¢æˆ¦ç•¥ã‚’æ±ºå®š
- **åˆ†é¡ã‚¿ã‚¤ãƒ—**:
  - `FILTERABLE`: æ•°å€¤ãƒ»ã‚«ãƒ†ã‚´ãƒªæ¡ä»¶ï¼ˆHPã€ã‚¿ã‚¤ãƒ—ã€ãƒ€ãƒ¡ãƒ¼ã‚¸ç­‰ï¼‰
  - `SEMANTIC`: æ„å‘³çš„æ¤œç´¢ï¼ˆæˆ¦ç•¥ã€ç›¸æ€§ã€ä½¿ç”¨æ„Ÿç­‰ï¼‰
  - `HYBRID`: è¤‡åˆæ¡ä»¶ï¼ˆè¤‡æ•°ã®æ¤œç´¢æ‰‹æ³•ãŒå¿…è¦ï¼‰
  - `GREETING`: æŒ¨æ‹¶ãƒ»é›‘è«‡ï¼ˆæ¤œç´¢ä¸è¦ï¼‰
- **ä»˜åŠ ä¾¡å€¤**: ã‚¯ã‚¨ãƒªè¦ç´„ãƒ»ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æŠ½å‡ºãƒ»ä¿¡é ¼åº¦ç®—å‡º

#### 3. **æ¤œç´¢å®Ÿè¡Œãƒ•ã‚§ãƒ¼ã‚º**
åˆ†é¡çµæœã«åŸºã¥ãã€æœ€é©ãªæ¤œç´¢æ‰‹æ³•ã‚’é¸æŠï¼š

```
FILTERABLE â†’ æ§‹é€ åŒ–DBæ¤œç´¢ï¼ˆå®Œå…¨ä¸€è‡´ãƒ»æ•°å€¤æ¯”è¼ƒï¼‰
SEMANTIC   â†’ ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ï¼ˆã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯é¡ä¼¼åº¦ï¼‰
HYBRID     â†’ ä¸¡æ¤œç´¢ã®ä¸¦åˆ—å®Ÿè¡Œ
```

#### 4. **çµæœçµ±åˆãƒ•ã‚§ãƒ¼ã‚º**
- **ãƒãƒ¼ã‚¸æˆ¦ç•¥**: åˆ†é¡ã‚¿ã‚¤ãƒ—åˆ¥ã®é‡ã¿ä»˜ã‘çµ±åˆ
- **ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°**: é–¢é€£åº¦ãƒ»æ¡ä»¶ãƒãƒƒãƒãƒ»è¤‡åˆãƒœãƒ¼ãƒŠã‚¹
- **å“è³ªè©•ä¾¡**: ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®é–¢é€£æ€§ãƒ»å®Œå…¨æ€§è©•ä¾¡

### å®Ÿè£…æ–¹é‡ã¨è¨­è¨ˆæ€æƒ³

#### A. **è¦ç´„ãƒ»åˆ†é¡ã‚·ã‚¹ãƒ†ãƒ ã®æ„å›³**

##### ç›®çš„
1. **æ¤œç´¢ç²¾åº¦ã®å‘ä¸Š**: æ›–æ˜§ãªè‡ªç„¶è¨€èªã‚¯ã‚¨ãƒªã‚’æ§‹é€ åŒ–ã•ã‚ŒãŸæ¤œç´¢ã‚¯ã‚¨ãƒªã«å¤‰æ›
2. **å‡¦ç†åŠ¹ç‡ã®æœ€é©åŒ–**: ä¸è¦ãªæ¤œç´¢ã‚’å›é¿ã—ã€é©åˆ‡ãªæ‰‹æ³•ã‚’é¸æŠ
3. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã®å‘ä¸Š**: æ„å›³ã«åˆè‡´ã—ãŸé«˜å“è³ªãªå›ç­”ã‚’æä¾›

##### ä»•çµ„ã¿
- **LLMåˆ†æ**: OpenAI GPTã«ã‚ˆã‚‹æ„å›³ç†è§£ãƒ»åˆ†é¡ãƒ»è¦ç´„
- **ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æŠ½å‡º**: æ¤œç´¢ã«é‡è¦ãªç”¨èªã®è‡ªå‹•æŠ½å‡º
- **ä¿¡é ¼åº¦è©•ä¾¡**: åˆ†é¡çµæœã®ç¢ºä¿¡åº¦ã«ã‚ˆã‚‹å‹•çš„æˆ¦ç•¥èª¿æ•´
- **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯**: ä½ä¿¡é ¼åº¦æ™‚ã®æ®µéšçš„ä»£æ›¿å‡¦ç†

##### æŠ€è¡“çš„ç‰¹å¾´
```python
# åˆ†é¡çµæœã®æ§‹é€ 
{
    "query_type": "HYBRID",
    "confidence": 0.85,
    "summary": "æ°´ã‚¿ã‚¤ãƒ—ã§ãƒ€ãƒ¡ãƒ¼ã‚¸40ä»¥ä¸Šã®æŠ€ã‚’æŒã¤ã‚«ãƒ¼ãƒ‰",
    "search_keywords": ["æ°´ã‚¿ã‚¤ãƒ—", "ãƒ€ãƒ¡ãƒ¼ã‚¸", "40ä»¥ä¸Š"],
    "filter_conditions": {
        "type": "æ°´",
        "damage": {"min": 40}
    }
}
```

#### B. **LLMãƒ»ãƒ™ã‚¯ãƒˆãƒ«DBã®å½¹å‰²åˆ†æ‹…**

##### **LLMï¼ˆLarge Language Modelï¼‰ã®è²¬å‹™**

1. **ã‚¯ã‚¨ãƒªç†è§£ãƒ»åˆ†é¡**
   - è‡ªç„¶è¨€èªã‚¯ã‚¨ãƒªã®æ„å›³åˆ†æ
   - 4ã¤ã®æ¤œç´¢ã‚¿ã‚¤ãƒ—ã¸ã®åˆ†é¡
   - æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºï¼ˆæ•°å€¤æ¡ä»¶ã€ã‚«ãƒ†ã‚´ãƒªç­‰ï¼‰

2. **å¿œç­”ç”Ÿæˆãƒ»å“è³ªåˆ¶å¾¡**
   - æ¤œç´¢çµæœã®çµ±åˆãƒ»è¦ç´„
   - ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«é©ã—ãŸå›ç­”ç”Ÿæˆ
   - é–¢é€£åº¦ã«åŸºã¥ãè©³ç´°åº¦èª¿æ•´

3. **å“è³ªä¿è¨¼ãƒ»ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯**
   - åˆ†é¡ä¿¡é ¼åº¦ã®è‡ªå·±è©•ä¾¡
   - ä½å“è³ªæ™‚ã®ä»£æ›¿æˆ¦ç•¥å®Ÿè¡Œ
   - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ»ä¾‹å¤–å‡¦ç†

##### **ãƒ™ã‚¯ãƒˆãƒ«DBï¼ˆUpstash Vectorï¼‰ã®è²¬å‹™**

1. **ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯æ¤œç´¢**
   - æ„å‘³çš„é¡ä¼¼åº¦ã«ã‚ˆã‚‹é–¢é€£ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æ¤œç´¢
   - å¤šæ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«ç©ºé–“ã§ã®è¿‘å‚æ¢ç´¢
   - OpenAI Embeddingsï¼ˆ1536æ¬¡å…ƒï¼‰ã«ã‚ˆã‚‹è¡¨ç¾å­¦ç¿’

2. **é«˜é€Ÿæ¤œç´¢ãƒ»ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£**
   - å¤§é‡ãƒ‡ãƒ¼ã‚¿ã®é«˜é€Ÿæ¤œç´¢ï¼ˆO(log n)æ™‚é–“è¨ˆç®—é‡ï¼‰
   - åˆ†æ•£å‡¦ç†ã«ã‚ˆã‚‹ä¸¦åˆ—æ¤œç´¢
   - ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æœ€é©åŒ–ã«ã‚ˆã‚‹æ€§èƒ½å‘ä¸Š

3. **ãƒ‡ãƒ¼ã‚¿ç®¡ç†ãƒ»æ°¸ç¶šåŒ–**
   - ãƒ™ã‚¯ãƒˆãƒ«æƒ…å ±ã®æ°¸ç¶šåŒ–
   - Namespaceåˆ†é›¢ã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿ç®¡ç†
   - ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ä»˜ããƒ™ã‚¯ãƒˆãƒ«ä¿å­˜

##### **çµ±åˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®åˆ©ç‚¹**

```
[LLM] â† æ„å‘³ç†è§£ãƒ»ç”Ÿæˆ â†’ [è‡ªç„¶è¨€èªå‡¦ç†]
  â†“
[åˆ†é¡ãƒ»ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°] â† æˆ¦ç•¥æ±ºå®š
  â†“
[ãƒ™ã‚¯ãƒˆãƒ«DB] â† é«˜é€Ÿæ¤œç´¢ â†’ [å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿]
  â†“
[çµæœçµ±åˆ] â† å“è³ªåˆ¶å¾¡ â†’ [LLM]
```

**ç›¸äº’è£œå®ŒåŠ¹æœ**:
- LLMã®ç†è§£åŠ› Ã— ãƒ™ã‚¯ãƒˆãƒ«DBã®æ¤œç´¢é€Ÿåº¦
- æ§‹é€ åŒ–æ¤œç´¢ã®æ­£ç¢ºæ€§ Ã— ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯æ¤œç´¢ã®æŸ”è»Ÿæ€§
- äººå·¥çŸ¥èƒ½ã®åˆ¤æ–­åŠ› Ã— ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ä¿¡é ¼æ€§

### ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

#### 1. ã‚¯ã‚¨ãƒªåˆ†é¡ã‚µãƒ¼ãƒ“ã‚¹ (`classification_service.py`)
- **æ©Ÿèƒ½**: OpenAI GPTã‚’ä½¿ç”¨ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¯ã‚¨ãƒªã‚’åˆ†æã—ã€é©åˆ‡ãªæ¤œç´¢æˆ¦ç•¥ã‚’æ±ºå®š
- **åˆ†é¡ã‚¿ã‚¤ãƒ—**:
  - `FILTERABLE`: HPå€¤ã‚„ã‚¿ã‚¤ãƒ—ãªã©æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã§æ¤œç´¢å¯èƒ½
  - `SEMANTIC`: æ„å‘³çš„ãªæ¤œç´¢ãŒå¿…è¦ï¼ˆæˆ¦ç•¥ã€ç›¸æ€§ãªã©ï¼‰
  - `HYBRID`: ä¸¡æ–¹ã®æ‰‹æ³•ã‚’çµ„ã¿åˆã‚ã›ã‚‹å¿…è¦ãŒã‚ã‚‹
  - `GREETING`: æŒ¨æ‹¶ã‚¯ã‚¨ãƒªï¼ˆæ¤œç´¢ã‚¹ã‚­ãƒƒãƒ—ã—ã¦å®šå‹å¿œç­”ï¼‰
- **ç²¾åº¦**: 90%ä»¥ä¸Šã®åˆ†é¡ç²¾åº¦ã‚’é”æˆ
- **è¤‡åˆæ¡ä»¶å¯¾å¿œ**: è¤‡æ•°ã®æ¡ä»¶ï¼ˆä¾‹ï¼šã€Œæ°´ã‚¿ã‚¤ãƒ— + ãƒ€ãƒ¡ãƒ¼ã‚¸40ä»¥ä¸Šã€ï¼‰ã‚’åŒæ™‚ã«èªè­˜ãƒ»æŠ½å‡º
- **æŒ¨æ‹¶æ¤œå‡ºæ©Ÿèƒ½**: æŒ¨æ‹¶ã‚¯ã‚¨ãƒªã‚’é«˜ç²¾åº¦ã§æ¤œå‡ºã—ã€æ¤œç´¢å‡¦ç†ã‚’ã‚¹ã‚­ãƒƒãƒ—

#### 2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¤œç´¢ã‚µãƒ¼ãƒ“ã‚¹ (`database_service.py`)
- **æ©Ÿèƒ½**: æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã™ã‚‹é«˜ç²¾åº¦ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
- **å¯¾å¿œæ¤œç´¢**:
  - HPå€¤ã®æ•°å€¤æ¯”è¼ƒï¼ˆ100ä»¥ä¸Šã€50ä»¥ä¸‹ãªã©ï¼‰
  - ã‚«ãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—ã®å®Œå…¨ä¸€è‡´æ¤œç´¢
  - **æŠ€ãƒ€ãƒ¡ãƒ¼ã‚¸æ¡ä»¶**: æ”»æ’ƒæŠ€ã®ãƒ€ãƒ¡ãƒ¼ã‚¸å€¤ã«ã‚ˆã‚‹æ•°å€¤ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼ˆ40ä»¥ä¸Šã€60ä»¥ä¸Šãªã©ï¼‰
  - **è¤‡åˆæ¡ä»¶æ¤œç´¢**: è¤‡æ•°æ¡ä»¶ã®åŒæ™‚é©ç”¨ï¼ˆä¾‹ï¼šæ°´ã‚¿ã‚¤ãƒ— + ãƒ€ãƒ¡ãƒ¼ã‚¸40ä»¥ä¸Šï¼‰
- **ç²¾åº¦**: 100%ã®æ­£ç¢ºæ€§

#### 3. ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ¤œç´¢çµ±åˆ (`hybrid_search_service.py`)
- **æ©Ÿèƒ½**: DBæ¤œç´¢ã¨ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ã®çµæœã‚’çµ±åˆ
- **ãƒãƒ¼ã‚¸æˆ¦ç•¥**:
  - **filterable**: DBæ¤œç´¢çµæœã‚’å„ªå…ˆï¼ˆä¿¡é ¼æ€§é‡è¦–ï¼‰
  - **semantic**: ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢çµæœã‚’å„ªå…ˆï¼ˆã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯é‡è¦–ï¼‰
  - **hybrid**: é‡ã¿ä»˜ã‘çµ±åˆï¼ˆDB: 0.4, Vector: 0.6ï¼‰

### API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

#### `/rag/search-test` (POST)
ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ¤œç´¢ã®ãƒ†ã‚¹ãƒˆå°‚ç”¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
```json
{
  "query": "HP100ä»¥ä¸Šã®ã‚«ãƒ¼ãƒ‰ã‚’æ•™ãˆã¦",
  "max_results": 10
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹**:
```json
{
  "answer": "HP100ä»¥ä¸Šã®ã‚«ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™...",
  "results": [...],
  "metadata": {
    "query_type": "filterable",
    "confidence": 0.95,
    "merge_strategy": "filterable",
    "db_results_count": 38,
    "vector_results_count": 0
  }
}
```

### ãƒ†ã‚¹ãƒˆçµæœ
- **ç·ãƒ†ã‚¹ãƒˆæ•°**: 41/41 å…¨ã¦æˆåŠŸï¼ˆ100%ï¼‰
- **åˆ†é¡ç²¾åº¦**: 90%ä»¥ä¸Š
- **HPæ¤œç´¢**: 38/100ä»¶ã®ã‚«ãƒ¼ãƒ‰ã‚’æ­£ç¢ºã«æ¤œå‡º
- **ã‚¿ã‚¤ãƒ—æ¤œç´¢**: 20/100ä»¶ã®ç‚ã‚¿ã‚¤ãƒ—ã‚«ãƒ¼ãƒ‰ã‚’æ­£ç¢ºã«æ¤œå‡º

### è¤‡åˆã‚¯ã‚¨ãƒªå¯¾å¿œ

#### æ¦‚è¦
è¤‡é›‘ãªæ¡ä»¶ã‚’çµ„ã¿åˆã‚ã›ãŸã‚¯ã‚¨ãƒªã€Œãƒ€ãƒ¡ãƒ¼ã‚¸ãŒ40ä»¥ä¸Šã®æŠ€ã‚’æŒã¤ã€æ°´ã‚¿ã‚¤ãƒ—ã‚«ãƒ¼ãƒ‰ã‚’æ•™ãˆã¦ã€ã®ã‚ˆã†ãªè¤‡åˆæ¡ä»¶æ¤œç´¢ã«å¯¾å¿œã—ã¾ã—ãŸã€‚

#### æ–°æ©Ÿèƒ½
- **è¤‡åˆæ¡ä»¶åˆ†é¡**: LLMãŒè¤‡æ•°ã®æ¡ä»¶ï¼ˆã‚¿ã‚¤ãƒ— + ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼‰ã‚’åŒæ™‚ã«èªè­˜
- **æ”»æ’ƒåŠ›ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°**: ã‚«ãƒ¼ãƒ‰ã®æŠ€ã®ãƒ€ãƒ¡ãƒ¼ã‚¸å€¤ã«ã‚ˆã‚‹æ•°å€¤æ¡ä»¶æ¤œç´¢
- **è¤‡åˆæ¡ä»¶ãƒœãƒ¼ãƒŠã‚¹**: è¤‡æ•°æ¡ä»¶ã‚’æº€ãŸã™ã‚¢ã‚¤ãƒ†ãƒ ã«å¯¾ã™ã‚‹é©åˆ‡ãªã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°
- **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å¼·åŒ–**: OpenAI APIç„¡ã—ã§ã‚‚å‹•ä½œã™ã‚‹å …ç‰¢æ€§

#### å¯¾å¿œæ¤œç´¢æ¡ä»¶
```bash
# ã‚¿ã‚¤ãƒ— + ãƒ€ãƒ¡ãƒ¼ã‚¸ã®è¤‡åˆæ¡ä»¶
"ãƒ€ãƒ¡ãƒ¼ã‚¸ãŒ40ä»¥ä¸Šã®æŠ€ã‚’æŒã¤ã€æ°´ã‚¿ã‚¤ãƒ—ã‚«ãƒ¼ãƒ‰ã‚’æ•™ãˆã¦"

# HP + ã‚¿ã‚¤ãƒ—ã®è¤‡åˆæ¡ä»¶  
"HP100ä»¥ä¸Šã®ç‚ã‚¿ã‚¤ãƒ—ã‚«ãƒ¼ãƒ‰ã‚’æ•™ãˆã¦"

# æ•°å€¤æ¡ä»¶ã®ã¿
"ãƒ€ãƒ¡ãƒ¼ã‚¸ãŒ60ä»¥ä¸Šã®æŠ€ã‚’æŒã¤ã‚«ãƒ¼ãƒ‰ã‚’æ•™ãˆã¦"
```

#### ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ æ”¹å–„
- **ã‚¿ã‚¤ãƒ—ãƒãƒƒãƒ**: +2.0ãƒã‚¤ãƒ³ãƒˆ
- **ãƒ€ãƒ¡ãƒ¼ã‚¸æ¡ä»¶ãƒãƒƒãƒ**: +2.0ãƒã‚¤ãƒ³ãƒˆï¼ˆ40ä»¥ä¸Šã€50ä»¥ä¸Šã€60ä»¥ä¸Šãªã©ï¼‰
- **HPæ¡ä»¶ãƒãƒƒãƒ**: +2.0ãƒã‚¤ãƒ³ãƒˆï¼ˆ100ä»¥ä¸Šã€150ä»¥ä¸Šãªã©ï¼‰
- **è¤‡åˆæ¡ä»¶ãƒœãƒ¼ãƒŠã‚¹**: +1.0ãƒã‚¤ãƒ³ãƒˆï¼ˆè¤‡æ•°æ¡ä»¶ã‚’åŒæ™‚ã«æº€ãŸã™å ´åˆï¼‰

#### å®Ÿè£…çµæœ
```bash
# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¾‹
python test_local_compound.py

# çµæœä¾‹ï¼ˆã‚«ãƒ¡ãƒƒã‚¯ã‚¹exï¼‰:
# - æ°´ã‚¿ã‚¤ãƒ—ãƒãƒƒãƒ: +2.0
# - ãƒ€ãƒ¡ãƒ¼ã‚¸40ä»¥ä¸Šãƒãƒƒãƒ: +2.0 Ã— 2å›ï¼ˆè¤‡æ•°æŠ€ï¼‰
# - è¤‡åˆæ¡ä»¶ãƒœãƒ¼ãƒŠã‚¹: +1.0
# - æœ€çµ‚ã‚¹ã‚³ã‚¢: 7.0
```

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
è©³ç´°ãªå®Ÿè£…ã‚¬ã‚¤ãƒ‰ã¯ [`hybrid_search_guide.md`](./docs/guides/hybrid_search_guide.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

---

## ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆæ–¹é‡

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£åŸå‰‡

#### 1. **è²¬ä»»åˆ†é›¢ã®åŸå‰‡**
- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãƒ»ä½“é¨“ã®æœ€é©åŒ–
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãƒ»ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã®å®Ÿè£…
- **AIå±¤**: è‡ªç„¶è¨€èªç†è§£ãƒ»ç”Ÿæˆã®å°‚é–€å‡¦ç†
- **ãƒ‡ãƒ¼ã‚¿å±¤**: æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ™ã‚¯ãƒˆãƒ«ãƒ‡ãƒ¼ã‚¿ã®ç®¡ç†

#### 2. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–æˆ¦ç•¥**
- **æ—©æœŸãƒªã‚¿ãƒ¼ãƒ³**: æŒ¨æ‹¶æ¤œå‡ºã«ã‚ˆã‚‹ä¸è¦å‡¦ç†ã®ã‚¹ã‚­ãƒƒãƒ—
- **ä¸¦åˆ—å‡¦ç†**: DBæ¤œç´¢ã¨ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ã®åŒæ™‚å®Ÿè¡Œ
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥**: åˆ†é¡çµæœãƒ»æ¤œç´¢çµæœã®é©åˆ‡ãªã‚­ãƒ£ãƒƒã‚·ãƒ¥
- **å‹•çš„èª¿æ•´**: ä¿¡é ¼åº¦ãƒ»å“è³ªã«åŸºã¥ããƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–

#### 3. **å“è³ªä¿è¨¼ä½“ç³»**
- **å¤šæ®µéšæ¤œè¨¼**: åˆ†é¡â†’æ¤œç´¢â†’çµ±åˆâ†’ç”Ÿæˆã®å„æ®µéšã§ã®å“è³ªç¢ºèª
- **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½**: å„å‡¦ç†ã®å¤±æ•—æ™‚ã®ä»£æ›¿æˆ¦ç•¥
- **ãƒ†ã‚¹ãƒˆé§†å‹•**: 91å€‹ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã«ã‚ˆã‚‹å“è³ªä¿è¨¼
- **ãƒ¡ãƒˆãƒªã‚¯ã‚¹ç›£è¦–**: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ»ç²¾åº¦ã®ç¶™ç¶šçš„æ¸¬å®š

### æŠ€è¡“é¸å®šç†ç”±

#### **OpenAI API**
- **é¸å®šç†ç”±**: é«˜å“è³ªãªè‡ªç„¶è¨€èªç†è§£ãƒ»ç”Ÿæˆèƒ½åŠ›
- **æ´»ç”¨é ˜åŸŸ**: ã‚¯ã‚¨ãƒªåˆ†é¡ã€è¦ç´„ç”Ÿæˆã€å¿œç­”ç”Ÿæˆ
- **æœ€é©åŒ–**: ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°

#### **Upstash Vector**
- **é¸å®šç†ç”±**: ã‚µãƒ¼ãƒãƒ¬ã‚¹ç’°å¢ƒã§ã®é«˜é€Ÿãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢
- **æŠ€è¡“ç‰¹å¾´**: Dense Indexã€Namespaceåˆ†é›¢ã€é«˜å¯ç”¨æ€§
- **ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£**: å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®åŠ¹ç‡çš„å‡¦ç†

#### **FastAPI + Pydantic**
- **é¸å®šç†ç”±**: é«˜æ€§èƒ½ãƒ»å‹å®‰å…¨ãªAPIé–‹ç™º
- **é–‹ç™ºåŠ¹ç‡**: è‡ªå‹•ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- **ä¿å®ˆæ€§**: æ˜ç¢ºãªå‹å®šç¾©ã€ãƒ†ã‚¹ã‚¿ãƒ“ãƒªãƒ†ã‚£

### æ‹¡å¼µæ€§è¨­è¨ˆ

#### **ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼æ§‹æˆ**
```python
services/
â”œâ”€â”€ classification_service.py    # åˆ†é¡ãƒ­ã‚¸ãƒƒã‚¯
â”œâ”€â”€ database_service.py         # DBæ¤œç´¢ãƒ­ã‚¸ãƒƒã‚¯  
â”œâ”€â”€ vector_service.py          # ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ãƒ­ã‚¸ãƒƒã‚¯
â”œâ”€â”€ hybrid_search_service.py   # çµ±åˆãƒ­ã‚¸ãƒƒã‚¯
â””â”€â”€ llm_service.py            # å¿œç­”ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯
```

#### **è¨­å®šé§†å‹•é–‹ç™º**
- ç’°å¢ƒå¤‰æ•°ã«ã‚ˆã‚‹å‹•çš„è¨­å®š
- é–¾å€¤ãƒ»ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å¤–éƒ¨åŒ–
- A/Bãƒ†ã‚¹ãƒˆå¯¾å¿œã®è¨­è¨ˆ

#### **ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å‹æ‹¡å¼µ**
- æ–°ã—ã„æ¤œç´¢æ‰‹æ³•ã®è¿½åŠ å®¹æ˜“æ€§
- åˆ†é¡ã‚¿ã‚¤ãƒ—ã®å‹•çš„è¿½åŠ 
- LLMãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®åˆ‡ã‚Šæ›¿ãˆå¯¾å¿œ

### LLMåˆ†é¡ã«åŸºã¥ãåŸ‹ã‚è¾¼ã¿æœ€é©åŒ–ã‚·ã‚¹ãƒ†ãƒ 

#### æ¦‚è¦
å¾“æ¥ã®å˜ç´”ãªè³ªå•æ–‡åŸ‹ã‚è¾¼ã¿ã‹ã‚‰ã€LLMåˆ†é¡çµæœã‚’æ´»ç”¨ã—ãŸæ™ºèƒ½çš„ãªåŸ‹ã‚è¾¼ã¿ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ ã«é€²åŒ–ã—ã¾ã—ãŸã€‚åˆ†é¡ã®ä¿¡é ¼åº¦ã‚„æŠ½å‡ºã•ã‚ŒãŸã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æƒ…å ±ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€æ¤œç´¢ç²¾åº¦ã‚’å¤§å¹…ã«å‘ä¸Šã•ã›ã¦ã„ã¾ã™ã€‚

#### ä¸»è¦æ©Ÿèƒ½

##### 1. ä¿¡é ¼åº¦ãƒ™ãƒ¼ã‚¹ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æˆ¦ç•¥
```python
# é«˜ä¿¡é ¼åº¦ï¼ˆ0.8ä»¥ä¸Šï¼‰: LLMã®è¦ç´„ã‚’ä½¿ç”¨
if classification.confidence >= 0.8:
    return classification.summary

# ä¸­ä¿¡é ¼åº¦ï¼ˆ0.5ä»¥ä¸Šï¼‰: ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ + å…ƒè³ªå•
elif classification.confidence >= 0.5:
    keywords_text = " ".join(classification.search_keywords)
    return f"{keywords_text} {original_query}"

# ä½ä¿¡é ¼åº¦ï¼ˆ0.5æœªæº€ï¼‰: å…ƒè³ªå•ã‚’ãã®ã¾ã¾ä½¿ç”¨
else:
    return original_query
```

##### 2. ã‚¯ã‚¨ãƒªã‚¿ã‚¤ãƒ—åˆ¥æœ€é©åŒ–
- **SEMANTIC**: æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å‰ç½®ã—ã¦ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯æ¤œç´¢ã‚’å¼·åŒ–
- **HYBRID**: æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ + ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®çµ„ã¿åˆã‚ã›ã§å¤šé¢çš„æ¤œç´¢
- **FILTERABLE**: ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã§å…ƒè³ªå•ã‚’ä½¿ç”¨ï¼ˆæ­£ç¢ºæ€§å„ªå…ˆï¼‰

##### 3. è¦ç´„å“è³ªã®è‡ªå‹•è©•ä¾¡
- é•·ã•ãƒã‚§ãƒƒã‚¯ï¼ˆ5æ–‡å­—ä»¥ä¸Šã€å…ƒè³ªå•ã®150%ä»¥ä¸‹ï¼‰
- ã‚²ãƒ¼ãƒ ã‚«ãƒ¼ãƒ‰ç‰¹æœ‰ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®ä¿æŒç¢ºèª
- é‡è¦æƒ…å ±æ¬ è½ã®é˜²æ­¢

#### å®Ÿè£…åŠ¹æœ
- **æ¤œç´¢ç²¾åº¦å‘ä¸Š**: ã‚ˆã‚Šé–¢é€£æ€§ã®é«˜ã„çµæœã‚’å–å¾—
- **ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆè±Šå¯ŒåŒ–**: ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æƒ…å ±ã«ã‚ˆã‚‹æ¤œç´¢å¼·åŒ–
- **ã‚·ã‚¹ãƒ†ãƒ å …ç‰¢æ€§**: æ®µéšçš„ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã«ã‚ˆã‚‹å®‰å®šæ€§ç¢ºä¿

### LLMå¿œç­”ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ ï¼ˆå“è³ªæœ€é©åŒ–ï¼‰

#### æ¦‚è¦
å¾“æ¥ã®ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ™ãƒ¼ã‚¹å¿œç­”ã‹ã‚‰ã€æ¤œç´¢çµæœã¨å…ƒè³ªå•ã‚’çµ±åˆã—ãŸé«˜å“è³ªãªå¿œç­”ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ ã«æ”¹ä¿®ã—ã¾ã—ãŸã€‚ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå“è³ªã®å‹•çš„åˆ†æã¨é–¢é€£åº¦ã«åŸºã¥ãå¿œç­”æˆ¦ç•¥ã«ã‚ˆã‚Šã€ç°¡æ½”ã§å®Ÿç”¨çš„ãªå›ç­”ã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚

#### ä¸»è¦æ©Ÿèƒ½

##### 1. çµ±åˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ§‹ç¯‰
```python
# æ¤œç´¢çµæœ + å…ƒè³ªå• + åˆ†é¡çµæœã®çµ±åˆ
enhanced_prompt = f"""
å…ƒã®è³ªå•: {query}
åˆ†é¡çµæœ: {classification.summary}
æ¤œç´¢ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ: {context_text}
å“è³ªãƒ¬ãƒ™ãƒ«: {context_quality['level']}
"""
```

##### 2. å‹•çš„å¿œç­”æˆ¦ç•¥
- **é«˜é–¢é€£åº¦(0.8+)**: è©³ç´°ã§å…·ä½“çš„ãªå›ç­”
- **ä¸­é–¢é€£åº¦(0.6-0.8)**: è¦ç‚¹ã‚’çµã£ãŸå›ç­”  
- **ä½é–¢é€£åº¦(0.4-0.6)**: ä¸€èˆ¬çš„ãªæ¡ˆå†…ï¼‹è¿½åŠ è³ªå•ã®ä¿ƒã—
- **æ¥µä½é–¢é€£åº¦(0.4æœªæº€)**: ä»£æ›¿ææ¡ˆã‚„æ¤œç´¢æ”¹å–„æ¡ˆ

##### 3. æŒ¨æ‹¶æ¤œå‡ºãƒ»æ—©æœŸå¿œç­”
- **æ¤œç´¢ã‚¹ã‚­ãƒƒãƒ—**: æŒ¨æ‹¶æ¤œå‡ºæ™‚ã¯ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ã‚’å®Œå…¨ã«ã‚¹ã‚­ãƒƒãƒ—
- **é«˜é€Ÿå¿œç­”**: å¹³å‡å¿œç­”æ™‚é–“ã‚’87%çŸ­ç¸®ï¼ˆ14.8ç§’â†’1.8ç§’ï¼‰
- **å®šå‹å¿œç­”**: ã‚²ãƒ¼ãƒ ã‚«ãƒ¼ãƒ‰é–¢é€£ã®è‡ªç„¶ãªæŒ¨æ‹¶å¿œç­”
- **æ¤œå‡ºç²¾åº¦**: 100%ã®æŒ¨æ‹¶æ¤œå‡ºç²¾åº¦

##### 4. ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–
- `max_tokens`: 500â†’300ï¼ˆç°¡æ½”æ€§å‘ä¸Šï¼‰
- `temperature`: 0.7â†’0.3ï¼ˆä¸€è²«æ€§å‘ä¸Šï¼‰
- `presence_penalty`: 0.1ï¼ˆå†—é•·æ€§å‰Šæ¸›ï¼‰
- `frequency_penalty`: 0.1ï¼ˆç¹°ã‚Šè¿”ã—å‰Šæ¸›ï¼‰

#### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å®Ÿæ¸¬çµæœ
- **æŒ¨æ‹¶å¿œç­”æ™‚é–“**: å¹³å‡1.8ç§’ï¼ˆæ¤œç´¢ã‚¹ã‚­ãƒƒãƒ—ï¼‰
- **é€šå¸¸å¿œç­”æ™‚é–“**: å¹³å‡14.8ç§’ï¼ˆæ¤œç´¢å®Ÿè¡Œï¼‰
- **æ¤œç´¢ã‚¹ã‚­ãƒƒãƒ—ç²¾åº¦**: 100%
- **å¿œç­”æ–‡å­—æ•°**: 100-200æ–‡å­—ã®æœ€é©åŒ–ã•ã‚ŒãŸå›ç­”
- **å¿œç­”å“è³ª**: é–¢é€£åº¦ã«åŸºã¥ãé©åˆ‡ãªè©³ç´°åº¦èª¿æ•´

#### å®Ÿè£…åŠ¹æœ
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“å‘ä¸Š**: æŒ¨æ‹¶ã«ã¯å³åº§ã«å¿œç­”ã€æƒ…å ±æ¤œç´¢ã«ã¯è³ªã®é«˜ã„å›ç­”
- **ã‚·ã‚¹ãƒ†ãƒ åŠ¹ç‡åŒ–**: ä¸è¦ãªæ¤œç´¢å‡¦ç†ã‚’å¤§å¹…å‰Šæ¸›ã—ã¦ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨é‡ã‚’æœ€é©åŒ–
- **å¿œç­”å“è³ªå‘ä¸Š**: ç°¡æ½”ã§å®Ÿç”¨çš„ã€æ–‡è„ˆã‚’ç†è§£ã—ãŸè‡ªç„¶ãªå›ç­”
- **ã‚·ã‚¹ãƒ†ãƒ å®‰å®šæ€§**: æ—¢å­˜æ©Ÿèƒ½ã¸ã®å½±éŸ¿ãªã—ã§æ–°æ©Ÿèƒ½ã‚’çµ±åˆ

---

## é–‹ç™ºç’°å¢ƒ

- `.nvmrc` ã«ã‚ˆã‚Š Node.js ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’çµ±ä¸€ï¼ˆä¾‹: `18`ï¼‰
- `.env.example` ã‚’ `.env` ã«ã‚³ãƒ”ãƒ¼ã—ã¦ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š
- `backend/requirements.txt` ã«ã‚ˆã‚Š Python ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å›ºå®š
- `package-lock.json` ã‚„ `package.json` ã¯**ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§ã¯ä¸è¦**ï¼ˆFastAPIé‹ç”¨æ™‚ï¼‰

| ãƒ„ãƒ¼ãƒ« / è¨€èª          | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¾‹    | å‚™è€ƒ                                      |
|----------------------|------------------|-------------------------------------------|
| Node.js              | 18.x ä»¥ä¸Š        | `nvm` ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆç”¨ï¼‰      |
| npm                  | 9.x ä»¥ä¸Š         | ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆç”¨ï¼‰              |
| React                | 19.x             | ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰UIãƒ©ã‚¤ãƒ–ãƒ©ãƒª                |
| Python               | 3.9ã€œ3.11        | åŸ‹ã‚è¾¼ã¿å‡¦ç†ã‚„RAGéƒ¨åˆ†ã§ä½¿ç”¨               |
| FastAPI              | æœ€æ–°             | ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰API                           |
| VS Code              | æœ€æ–°             | é–‹ç™ºç”¨IDE                                 |
| Git                  | æœ€æ–°             | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ãƒ„ãƒ¼ãƒ«                      |
| OpenAI API           | åˆ©ç”¨äºˆå®š         | `.env` ã«ã‚­ãƒ¼ã‚’è¨­å®š                       |
| Upstash Vector       | åˆ©ç”¨äºˆå®š         | `.env` ã«URLãƒ»ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è¨­å®š              |

### ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ãƒ•ã‚¡ã‚¤ãƒ«

- `.nvmrc`: Node.js ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³æŒ‡å®š
- `.venv/`: Python ä»®æƒ³ç’°å¢ƒãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆ`python -m venv .venv` ã§ä½œæˆï¼‰
- `backend/requirements.txt`: Python ã®ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä¸€è¦§ï¼ˆé–‹ç™ºãƒ»æœ¬ç•ªä¸¡ç”¨ï¼‰
- `.env.example`: ç’°å¢ƒå¤‰æ•°ã®çµ±åˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆé–‹ç™ºãƒ»æœ¬ç•ªä¾‹ã‚’å«ã‚€ï¼‰
- `backend/.env.production.template`: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰æœ¬ç•ªç’°å¢ƒç”¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
- `frontend/.env.production.template`: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æœ¬ç•ªç’°å¢ƒç”¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ  
- `frontend/.env.local.template`: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºç’°å¢ƒç”¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

### ä¾å­˜é–¢ä¿‚ç®¡ç†

- **çµ±ä¸€requirements.txt**: é–‹ç™ºç’°å¢ƒã¨æœ¬ç•ªç’°å¢ƒã§åŒã˜ä¾å­˜é–¢ä¿‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ï¼ˆbackend/requirements.txtï¼‰
- **å…¨æ©Ÿèƒ½å¯¾å¿œ**: JWTèªè¨¼ã€Redisã€Gunicornç­‰ã®æœ¬ç•ªæ©Ÿèƒ½ã‚‚å«ã‚€
- **å …ç‰¢ãªè¨­è¨ˆ**: å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒä¸è¶³ã—ã¦ã„ã‚‹å ´åˆã¯é©åˆ‡ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯

**è©³ç´°**: [ä¾å­˜é–¢ä¿‚ã‚¬ã‚¤ãƒ‰](docs/guides/dependencies.md) ã‚’å‚ç…§

---

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### Docker ã‚’ä½¿ç”¨ã—ãŸç’°å¢ƒæ§‹ç¯‰ï¼ˆæ¨å¥¨ï¼‰

**å‰ææ¡ä»¶**:
- Docker Desktop ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨
- Docker Compose ãŒåˆ©ç”¨å¯èƒ½ã§ã‚ã‚‹ã“ã¨

**ç‰¹å¾´**:
- **è»½é‡åŒ–**: Alpine Linux ãƒ™ãƒ¼ã‚¹ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½¿ç”¨
- **æœ€é©åŒ–**: ãƒãƒ«ãƒã‚¹ãƒ†ãƒ¼ã‚¸ãƒ“ãƒ«ãƒ‰ã«ã‚ˆã‚‹æœ¬ç•ªç’°å¢ƒæœ€é©åŒ–
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: æœ€å°é™ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§æ”»æ’ƒé¢ã‚’å‰Šæ¸›
- **ä¸€è²«æ€§**: é–‹ç™ºãƒ»æœ¬ç•ªç’°å¢ƒã§ã®ã‚¤ãƒ¡ãƒ¼ã‚¸çµ±ä¸€

#### é–‹ç™ºç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
git clone https://github.com/yourname/gamechat-ai.git
cd gamechat-ai

# è‡ªå‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ
./scripts/dev-setup.sh
```

ã¾ãŸã¯æ‰‹å‹•ã§ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—:

```bash
# ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
cp .env.example backend/.env
# backend/.envãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã—ã¦å®Ÿéš›ã®APIã‚­ãƒ¼ã‚’è¨­å®š

# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç”¨ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
# cp .env.example frontend/.env.local
# frontend/.env.localãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†

# Docker ã‚µãƒ¼ãƒ“ã‚¹ã‚’ãƒ“ãƒ«ãƒ‰ãƒ»èµ·å‹•ï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã¿ï¼‰
docker-compose up --build -d backend
```

#### ğŸ” ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

**âš ï¸ é‡è¦**: å®Ÿéš›ã®APIã‚­ãƒ¼ã¯çµ¶å¯¾ã«Gitã«ã‚³ãƒŸãƒƒãƒˆã—ãªã„ã§ãã ã•ã„ã€‚

**çµ±ä¸€ç’°å¢ƒè¨­å®šãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ**:
```bash
# çµ±ä¸€ç’°å¢ƒè¨­å®šãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç¢ºèª
cat .env.template

# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç’°å¢ƒå¤‰æ•°ã‚’ä½œæˆ
cp .env.template backend/.env
# backend/.env ã‚’ç·¨é›†ã—ã¦å®Ÿéš›ã®APIã‚­ãƒ¼ã‚’è¨­å®š

# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç’°å¢ƒå¤‰æ•°ï¼ˆé€šå¸¸ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§å‹•ä½œã€å¿…è¦ã«å¿œã˜ã¦ä½œæˆï¼‰
# cp .env.template frontend/.env.local
```

**å¿…é ˆè¨­å®šé …ç›®**:
- `OPENAI_API_KEY`: OpenAI APIã‚­ãƒ¼
- `UPSTASH_VECTOR_REST_URL`: Upstash Vector URL
- `UPSTASH_VECTOR_REST_TOKEN`: Upstash Vectorãƒˆãƒ¼ã‚¯ãƒ³

è©³ç´°ã¯ [`.env.template`](.env.template) ãŠã‚ˆã³ [`docs/guides/environment-setup.md`](docs/guides/environment-setup.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

#### é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•

**ä¸€æ‹¬èµ·å‹•ï¼ˆæ¨å¥¨ï¼‰**:
```bash
npm install
npm run dev:full  # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ + ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’åŒæ™‚èµ·å‹•
```

**å€‹åˆ¥èµ·å‹•**:
```bash
# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã¿ï¼ˆNext.jsï¼‰
cd frontend
npm run dev          # é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ï¼ˆhttp://localhost:3000ï¼‰

# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã¿ï¼ˆFastAPIï¼‰
cd backend
# å¿…è¦ã«å¿œã˜ã¦ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install -r requirements.txt
# ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ï¼ˆä¾‹: uvicornï¼‰
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000  # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆhttp://localhost:8000ï¼‰
```

**æ³¨æ„**: ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ã¯å¿…ãšãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰è¡Œã£ã¦ãã ã•ã„ã€‚ç›¸å¯¾ã‚¤ãƒ³ãƒãƒ¼ãƒˆãŒæ­£ã—ãå‹•ä½œã—ã¾ã™ã€‚

---

## ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
gamechat-ai/
â”œâ”€â”€ frontend/                     # Next.js + TypeScriptï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰
â”‚   â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app/                  # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ components/           # UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ hooks/                # Reactã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯
â”‚   â”‚   â”œâ”€â”€ lib/                  # ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ»ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”‚   â””â”€â”€ utils/                # æ±ç”¨ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ postcss.config.js
â”‚   â”œâ”€â”€ tailwind.config.js
â”‚   â”œâ”€â”€ vitest.config.ts
â”‚   â”œâ”€â”€ vitest.setup.ts
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â””â”€â”€ .env
â”‚
â”œâ”€â”€ backend/                      # Python + FastAPIï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIï¼‰
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ main.py                 # FastAPIã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”‚   â””â”€â”€ ng_words.py
â”‚   â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”‚   â”œâ”€â”€ config.py          # ç’°å¢ƒå¤‰æ•°ãƒ»è¨­å®š
â”‚   â”‚   â”‚   â”œâ”€â”€ exception_handlers.py
â”‚   â”‚   â”‚   â”œâ”€â”€ security.py        # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š
â”‚   â”‚   â”‚   â”œâ”€â”€ database.py        # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶š
â”‚   â”‚   â”‚   â”œâ”€â”€ background_tasks.py # ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¿ã‚¹ã‚¯
â”‚   â”‚   â”‚   â”œâ”€â”€ intrusion_detection.py  # ä¾µå…¥æ¤œçŸ¥
â”‚   â”‚   â”‚   â”œâ”€â”€ security_audit.py  # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»
â”‚   â”‚   â”‚   â””â”€â”€ logging.py         # ãƒ­ã‚°è¨­å®š
â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”‚   â”œâ”€â”€ rag_models.py      # Pydanticãƒ¢ãƒ‡ãƒ«
â”‚   â”‚   â”‚   â””â”€â”€ classification_models.py  # åˆ†é¡é–¢é€£ãƒ¢ãƒ‡ãƒ«
â”‚   â”‚   â”œâ”€â”€ routers/
â”‚   â”‚   â”‚   â””â”€â”€ rag.py             # APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”‚   â””â”€â”€ services/
â”‚   â”‚       â”œâ”€â”€ auth_service.py    # èªè¨¼å‡¦ç†
â”‚   â”‚       â”œâ”€â”€ classification_service.py  # LLMåˆ†é¡ã‚µãƒ¼ãƒ“ã‚¹
â”‚   â”‚       â”œâ”€â”€ database_service.py        # DBæ¤œç´¢ã‚µãƒ¼ãƒ“ã‚¹
â”‚   â”‚       â”œâ”€â”€ hybrid_search_service.py   # ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ¤œç´¢çµ±åˆ
â”‚   â”‚       â”œâ”€â”€ embedding_service.py  # ã‚¨ãƒ³ãƒ™ãƒ‡ã‚£ãƒ³ã‚°
â”‚   â”‚       â”œâ”€â”€ vector_service.py  # ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢
â”‚   â”‚       â”œâ”€â”€ rag_service.py     # RAGå‡¦ç†
â”‚   â”‚       â”œâ”€â”€ llm_service.py     # LLMå‡¦ç†
â”‚   â”‚       â””â”€â”€ storage_service.py # ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚µãƒ¼ãƒ“ã‚¹
â”‚   â””â”€â”€ tests/                       # ãƒ†ã‚¹ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆæ©Ÿèƒ½åˆ¥æ§‹æˆï¼‰
â”‚       â”œâ”€â”€ conftest.py            # å…±é€šãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ãƒ»è¨­å®š
â”‚       â”œâ”€â”€ fixtures/              # ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ¢ãƒƒã‚¯ãƒ»ãƒ˜ãƒ«ãƒ‘ãƒ¼
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”œâ”€â”€ mock_factory.py    # ãƒ¢ãƒƒã‚¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼
â”‚       â”‚   â””â”€â”€ test_helpers.py    # ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ãƒ˜ãƒ«ãƒ‘ãƒ¼
â”‚       â”œâ”€â”€ services/              # ã‚µãƒ¼ãƒ“ã‚¹å±¤ãƒ†ã‚¹ãƒˆ
â”‚       â”‚   â”œâ”€â”€ test_classification_consolidated.py
â”‚       â”‚   â”œâ”€â”€ test_embedding_consolidated.py
â”‚       â”‚   â”œâ”€â”€ test_hybrid_search_consolidated.py
â”‚       â”‚   â”œâ”€â”€ test_vector_service_consolidated.py
â”‚       â”‚   â”œâ”€â”€ test_database_service.py
â”‚       â”‚   â””â”€â”€ test_llm_service.py
â”‚       â”œâ”€â”€ api/                   # APIå±¤ãƒ†ã‚¹ãƒˆ
â”‚       â”‚   â”œâ”€â”€ test_api.py
â”‚       â”‚   â”œâ”€â”€ test_api_safety.py
â”‚       â”‚   â””â”€â”€ __init__.py
â”‚       â”œâ”€â”€ integration/           # çµ±åˆãƒ†ã‚¹ãƒˆ
â”‚       â”‚   â”œâ”€â”€ test_full_flow_integration.py
â”‚       â”‚   â”œâ”€â”€ test_rag_service_responses.py
â”‚       â”‚   â””â”€â”€ __init__.py
â”‚       â”œâ”€â”€ performance/           # ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
â”‚       â”‚   â”œâ”€â”€ test_performance_quality_metrics.py
â”‚       â”‚   â””â”€â”€ __init__.py
â”‚       â”œâ”€â”€ test_security_implementation.py  # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ
â”‚       â””â”€â”€ README.md              # ãƒ†ã‚¹ãƒˆæ§‹æˆãƒ»å®Ÿè¡Œæ–¹æ³•ã®è©³ç´°
â”‚
â”œâ”€â”€ data/                         # æ”»ç•¥ãƒ‡ãƒ¼ã‚¿ï¼ˆgitç®¡ç†å¤–ï¼‰
â”‚
â”œâ”€â”€ scripts/                      # é–‹ç™ºãƒ»é‹ç”¨ãƒ„ãƒ¼ãƒ«
â”‚   â”œâ”€â”€ README.md                 # ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½¿ç”¨ã‚¬ã‚¤ãƒ‰
â”‚   â”œâ”€â”€ data-processing/          # ãƒ‡ãƒ¼ã‚¿å‡¦ç†
â”‚   â”‚   â”œâ”€â”€ convert_to_format.py  # ãƒ‡ãƒ¼ã‚¿å½¢å¼å¤‰æ›
â”‚   â”‚   â”œâ”€â”€ embedding.py          # åŸ‹ã‚è¾¼ã¿ç”Ÿæˆ
â”‚   â”‚   â””â”€â”€ upstash_connection.py # Vector DBã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ deployment/               # ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ prod-deploy.sh        # æœ¬ç•ªç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤
â”‚   â”‚   â”œâ”€â”€ cloud-run-deploy.sh   # Cloud Runãƒ‡ãƒ—ãƒ­ã‚¤
â”‚   â”‚   â”œâ”€â”€ firebase-deploy.sh    # Firebase Hostingãƒ‡ãƒ—ãƒ­ã‚¤
â”‚   â”‚   â”œâ”€â”€ migrate-to-firebase.sh # Firebaseç§»è¡Œ
â”‚   â”‚   â””â”€â”€ upload_data_to_gcs.py # GCSãƒ‡ãƒ¼ã‚¿ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ testing/                  # ãƒ†ã‚¹ãƒˆãƒ»æ¤œè¨¼
â”‚   â”‚   â”œâ”€â”€ test_greeting_detection.py  # æŒ¨æ‹¶æ¤œå‡ºãƒ†ã‚¹ãƒˆ
â”‚   â”‚   â”œâ”€â”€ test_performance.py   # ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
â”‚   â”‚   â”œâ”€â”€ simple_performance_test.py  # ç°¡æ˜“æ€§èƒ½ãƒ†ã‚¹ãƒˆ
â”‚   â”‚   â”œâ”€â”€ performance_optimization_test.py  # æœ€é©åŒ–ãƒ†ã‚¹ãƒˆ
â”‚   â”‚   â”œâ”€â”€ test-pipeline.sh      # CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆ
â”‚   â”‚   â”œâ”€â”€ test-pipeline-local.sh # ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆ
â”‚   â”‚   â””â”€â”€ lighthouse-audit.sh   # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç›£æŸ»
â”‚   â””â”€â”€ utilities/                # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚       â”œâ”€â”€ dev-setup.sh          # é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
â”‚       â”œâ”€â”€ diagnose-config.py    # è¨­å®šè¨ºæ–­ãƒ„ãƒ¼ãƒ«
â”‚       â”œâ”€â”€ check-env-security.sh # ç’°å¢ƒå¤‰æ•°ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯
â”‚       â”œâ”€â”€ security-check.sh     # ã‚·ã‚¹ãƒ†ãƒ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»
â”‚       â””â”€â”€ verify-api-keys.sh    # APIã‚­ãƒ¼æ¤œè¨¼
â”‚
â”œâ”€â”€ docs/                         # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ README.md                 # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå…¨ä½“ã®æ¡ˆå†…
â”‚   â”œâ”€â”€ project-status.md         # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆçŠ¶æ³ãƒ»è¨ˆç”»
â”‚   â”œâ”€â”€ api/                      # APIä»•æ§˜ãƒ»è¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ README.md             # APIè¨­è¨ˆåŸå‰‡ãƒ»æ‹¡å¼µäºˆå®š
â”‚   â”‚   â””â”€â”€ rag_api_spec.md       # RAG APIä»•æ§˜æ›¸
â”‚   â”œâ”€â”€ guides/                   # å®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ»ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«
â”‚   â”‚   â”œâ”€â”€ README.md             # ã‚¬ã‚¤ãƒ‰ä½¿ç”¨æ–¹æ³•ãƒ»æ›´æ–°ãƒ«ãƒ¼ãƒ«
â”‚   â”‚   â”œâ”€â”€ dependencies.md       # ä¾å­˜é–¢ä¿‚ã¨é–‹ç™ºã‚¬ã‚¤ãƒ‰
â”‚   â”‚   â”œâ”€â”€ hybrid_search_guide.md    # ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ¤œç´¢å®Ÿè£…ã‚¬ã‚¤ãƒ‰
â”‚   â”‚   â”œâ”€â”€ llm_response_enhancement.md  # LLMå¿œç­”ç”Ÿæˆæ”¹ä¿®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ vector_search_optimization_guide.md  # ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢æœ€é©åŒ–ã‚¬ã‚¤ãƒ‰
â”‚   â”‚   â”œâ”€â”€ talk-guidelines.md    # é›‘è«‡å¯¾å¿œã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³
â”‚   â”‚   â”œâ”€â”€ assistant-ui-notes.md # UIãƒ‡ã‚¶ã‚¤ãƒ³ãƒ»å®Ÿè£…ãƒ¡ãƒ¢
â”‚   â”‚   â””â”€â”€ recaptcha-setup.md    # reCAPTCHAè¨­å®šã‚¬ã‚¤ãƒ‰
â”‚   â”œâ”€â”€ deployment/               # ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆãƒ»ã‚¤ãƒ³ãƒ•ãƒ©
â”‚   â”‚   â”œâ”€â”€ README.md             # ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆå…¨ä½“ã‚¬ã‚¤ãƒ‰
â”‚   â”‚   â”œâ”€â”€ deployment-guide.md   # åŒ…æ‹¬çš„ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¬ã‚¤ãƒ‰
â”‚   â”‚   â”œâ”€â”€ cloud-services-overview.md  # ã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹å…¨ä½“æ¦‚è¦
â”‚   â”‚   â”œâ”€â”€ DOCKER_USAGE.md       # Dockeråˆ©ç”¨ã‚¬ã‚¤ãƒ‰
â”‚   â”‚   â”œâ”€â”€ cloud-run-openai-setup.md   # OpenAIè¨­å®š
â”‚   â”‚   â”œâ”€â”€ api-key-authentication-implementation-report.md  # èªè¨¼å®Ÿè£…ãƒ¬ãƒãƒ¼ãƒˆ
â”‚   â”‚   â”œâ”€â”€ cloud-storage-implementation-report.md  # ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å®Ÿè£…ãƒ¬ãƒãƒ¼ãƒˆ
â”‚   â”‚   â”œâ”€â”€ frontend-sentry-implementation-report.md  # Sentryå®Ÿè£…ãƒ¬ãƒãƒ¼ãƒˆ
â”‚   â”‚   â””â”€â”€ firebase-api-key-regeneration-report.md  # Firebase APIã‚­ãƒ¼æ›´æ–°ãƒ¬ãƒãƒ¼ãƒˆ
â”‚   â”œâ”€â”€ performance/              # ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹é–¢é€£
â”‚   â”‚   â”œâ”€â”€ README.md             # ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–ãƒ»æœ€é©åŒ–ç›®æ¨™
â”‚   â”‚   â”œâ”€â”€ performance_results.json  # ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®šçµæœ
â”‚   â”‚   â””â”€â”€ frontend-optimization.md  # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æœ€é©åŒ–
â”‚   â”œâ”€â”€ security/                 # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ README.md             # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å…¨ä½“ã‚¬ã‚¤ãƒ‰
â”‚   â”‚   â”œâ”€â”€ comprehensive-security-report.md  # åŒ…æ‹¬çš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒãƒ¼ãƒˆ
â”‚   â”‚   â”œâ”€â”€ security-assessment-report.md     # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è©•ä¾¡ãƒ¬ãƒãƒ¼ãƒˆ
â”‚   â”‚   â”œâ”€â”€ security-enhancement-implementation-report.md  # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–å®Ÿè£…ãƒ¬ãƒãƒ¼ãƒˆ
â”‚   â”‚   â””â”€â”€ firebase-security-audit-report.md  # Firebase ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ãƒ¬ãƒãƒ¼ãƒˆ
â”‚   â”œâ”€â”€ testing/                  # ãƒ†ã‚¹ãƒˆãƒ»å“è³ªä¿è¨¼
â”‚   â”‚   â”œâ”€â”€ e2e-test-issues.md    # E2Eãƒ†ã‚¹ãƒˆå•é¡Œãƒ¬ãƒãƒ¼ãƒˆ
â”‚   â”‚   â”œâ”€â”€ e2e-test-final-report.md  # E2Eãƒ†ã‚¹ãƒˆä¿®æ­£æœ€çµ‚ãƒ¬ãƒãƒ¼ãƒˆ
â”‚   â”‚   â””â”€â”€ github-issues-proposal.md  # GitHub Issueææ¡ˆ
â”‚   â””â”€â”€ sphinx/                   # Sphinxãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆ
â”‚       â”œâ”€â”€ conf.py               # Sphinxè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”‚       â”œâ”€â”€ index.rst             # ãƒ¡ã‚¤ãƒ³ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚       â”œâ”€â”€ Makefile              # ãƒ“ãƒ«ãƒ‰ç”¨Makefile
â”‚       â””â”€â”€ services/             # ã‚µãƒ¼ãƒ“ã‚¹å±¤APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚
â”œâ”€â”€ .nvmrc
â”œâ”€â”€ README.md
â”œâ”€â”€ .env.example
â””â”€â”€ .gitignore
```

---

## ãƒ™ã‚¯ãƒˆãƒ«DBï¼ˆUpstash Vectorï¼‰ã¸ã®ã‚¤ãƒ³ãƒ‡ã‚¯ã‚·ãƒ³ã‚°ãƒ»ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

### æ¦‚è¦
ã‚¨ãƒ³ãƒ™ãƒ‡ã‚£ãƒ³ã‚°æ¸ˆã¿ã®æ”»ç•¥ãƒ‡ãƒ¼ã‚¿ï¼ˆä¾‹: `embedding_list.jsonl`ï¼‰ã‚’ã€Upstash Vectorã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã€ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢å¯èƒ½ãªçŠ¶æ…‹ã«ã—ã¾ã™ã€‚

### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ç®¡ç†æ–¹é‡
- Upstash Vectorã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯ã€ŒDenseï¼ˆå¯†ï¼‰ã€å‹ã§ä½œæˆã—ã¦ãã ã•ã„ï¼ˆOpenAIã®ã‚¨ãƒ³ãƒ™ãƒ‡ã‚£ãƒ³ã‚°ã¯å¯†ãƒ™ã‚¯ãƒˆãƒ«ã§ã™ï¼‰ã€‚
- ãƒ‡ãƒ¼ã‚¿ã”ã¨ã« `namespace` ã‚’åˆ†ã‘ã¦ç®¡ç†ã™ã‚‹ã“ã¨ã§ã€ç”¨é€”ã‚„ç¨®é¡ã”ã¨ã®æ¤œç´¢ãŒå¯èƒ½ã§ã™ã€‚
- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®URLã‚„ãƒˆãƒ¼ã‚¯ãƒ³ã¯ `.env` ã§å®‰å…¨ã«ç®¡ç†ã—ã¾ã™ã€‚

### ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å‡¦ç†
- `scripts/upstash_connection.py` ã‚’åˆ©ç”¨ã—ã¦ã€`embedding_list.jsonl` ã®å„è¡Œï¼ˆ1ãƒ™ã‚¯ãƒˆãƒ«ãšã¤ï¼‰ã‚’Upstash Vectorã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚
- ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å®Ÿè¡Œã—ã¾ã™ã€‚

```bash
python upstash_connection.py
```

### ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ä¸»ãªæµã‚Œ:
- .env ã‹ã‚‰Upstashã®æ¥ç¶šæƒ…å ±ã‚’èª­ã¿è¾¼ã‚€
- embedding_list.jsonl ã‚’1è¡Œãšã¤èª­ã¿è¾¼ã¿ã€å„ãƒ™ã‚¯ãƒˆãƒ«ã‚’ Vector ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦ç”Ÿæˆ
- namespace ã”ã¨ã«Upstash Vectorã¸ upsert ã§ç™»éŒ²
- ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãŒå®Œäº†ã—ãŸãƒ™ã‚¯ãƒˆãƒ«IDã‚’æ¨™æº–å‡ºåŠ›ã«è¡¨ç¤º

### æ³¨æ„äº‹é …
- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®å‹ï¼ˆDense/Sparseï¼‰ãŒãƒ‡ãƒ¼ã‚¿ã¨ä¸€è‡´ã—ã¦ã„ã‚‹ã“ã¨ã‚’å¿…ãšç¢ºèªã—ã¦ãã ã•ã„ã€‚
- APIã‚­ãƒ¼ã‚„ãƒˆãƒ¼ã‚¯ãƒ³ãªã©ã®æ©Ÿå¯†æƒ…å ±ã¯ .env ã§ç®¡ç†ã—ã€Gitã«ã¯çµ¶å¯¾ã«å«ã‚ãªã„ã§ãã ã•ã„ã€‚
- å¤§é‡ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹å ´åˆã¯ã€APIãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚„ã‚¨ãƒ©ãƒ¼å‡¦ç†ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

---

## RAG APIä»•æ§˜

æœ¬APIã¯ã‚«ãƒ¼ãƒ‰ã‚²ãƒ¼ãƒ ã®ã‚«ãƒ¼ãƒ‰åã«é–¢ã™ã‚‹è‡ªç„¶è¨€èªã®è³ªå•ã«å¯¾ã—ã€æ¤œç´¢æ‹¡å¼µç”Ÿæˆï¼ˆRAGï¼‰ã‚’ç”¨ã„ãŸå›ç­”ã‚’è¿”ã—ã¾ã™ã€‚

- ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼šPOST `/api/rag/query`
- ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¾‹ãƒ»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹ãƒ»ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–ãªã©ã¯ [RAG APIä»•æ§˜æ›¸](./docs/rag_api_spec.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

---

## ãƒ†ã‚¹ãƒˆç’°å¢ƒãƒ»å®Ÿè¡Œæ–¹æ³•

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆï¼ˆVitestï¼‰
ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¨ã—ã¦ [Vitest](https://vitest.dev/) ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚Vitest ã¯ Vite ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ãŸé«˜é€Ÿãªãƒ†ã‚¹ãƒˆãƒ©ãƒ³ãƒŠãƒ¼ã§ã™ã€‚

#### ä¸»ãªãƒ†ã‚¹ãƒˆé–¢é€£ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰
- **vitest**: é«˜é€Ÿãªãƒ†ã‚¹ãƒˆãƒ©ãƒ³ãƒŠãƒ¼ã€‚
- **@testing-library/react**: React ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆã‚’å®¹æ˜“ã«ã™ã‚‹ãŸã‚ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã€‚
- **@testing-library/jest-dom**: DOM ã®çŠ¶æ…‹ã‚’ã‚¢ã‚µãƒ¼ãƒˆã™ã‚‹ãŸã‚ã®ã‚«ã‚¹ã‚¿ãƒ  Jest ãƒãƒƒãƒãƒ£ã‚’æä¾› (Vitest ã§ã‚‚åˆ©ç”¨å¯èƒ½)ã€‚
- **@testing-library/user-event**: ã‚ˆã‚Šç¾å®Ÿã«è¿‘ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã€‚
- **jsdom**: ãƒ†ã‚¹ãƒˆç’°å¢ƒã§ãƒ–ãƒ©ã‚¦ã‚¶ã® DOM API ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã€‚
- **@vitejs/plugin-react**: Vitest ã§ React ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ãŸã‚ã® Vite ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã€‚
- **@types/jest**: Jest ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªå‹å®šç¾©ï¼ˆ`describe`, `it` ãªã©ï¼‰ã€‚Vitest ã¯ Jest ã¨äº’æ›æ€§ã®ã‚ã‚‹ API ã‚’å¤šãæä¾›ã—ã¦ãŠã‚Šã€`globals: true` è¨­å®šã¨åˆã‚ã›ã¦ã“ã‚Œã‚‰ã®å‹å®šç¾©ãŒåˆ©ç”¨ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

#### è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
- **`frontend/vitest.config.ts`**: Vitest ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã€‚ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®å ´æ‰€ã€ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆã€ã‚«ãƒãƒ¬ãƒƒã‚¸è¨­å®šãªã©ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚
- **`frontend/vitest.setup.ts`**: ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªãƒ†ã‚¹ãƒˆã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã€‚`@testing-library/jest-dom` ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆãªã©ã€å„ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®å‰ã«å®Ÿè¡Œã—ãŸã„å‡¦ç†ã‚’è¨˜è¿°ã—ã¾ã™ã€‚
- **`frontend/tsconfig.json`**: TypeScript ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã€‚Vitest ã¯ã“ã®è¨­å®šï¼ˆç‰¹ã« `paths` ã‚¨ã‚¤ãƒªã‚¢ã‚¹ãªã©ï¼‰ã‚’å‚ç…§ã—ã¾ã™ã€‚

#### ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ
`frontend` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

- **ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ:**
```bash
  npm test
 ```


### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆï¼ˆpytestï¼‰
ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIã¨ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ†ã‚¹ãƒˆã«ã¯ [pytest](https://pytest.org/) ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚

#### ãƒ†ã‚¹ãƒˆæ§‹æˆï¼ˆæ©Ÿèƒ½åˆ¥ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ï¼‰

```
backend/app/tests/
â”œâ”€â”€ conftest.py                    # å…±é€šãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ãƒ»è¨­å®š
â”œâ”€â”€ fixtures/                     # ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ¢ãƒƒã‚¯ãƒ»ãƒ˜ãƒ«ãƒ‘ãƒ¼
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ mock_factory.py           # ãƒ¢ãƒƒã‚¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼
â”‚   â””â”€â”€ test_helpers.py           # ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ãƒ˜ãƒ«ãƒ‘ãƒ¼
â”œâ”€â”€ services/                     # ã‚µãƒ¼ãƒ“ã‚¹å±¤ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ test_classification_consolidated.py
â”‚   â”œâ”€â”€ test_embedding_consolidated.py
â”‚   â”œâ”€â”€ test_hybrid_search_consolidated.py
â”‚   â”œâ”€â”€ test_vector_service_consolidated.py
â”‚   â”œâ”€â”€ test_database_service.py
â”‚   â””â”€â”€ test_llm_service.py
â”œâ”€â”€ api/                          # APIå±¤ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ test_api.py
â”‚   â””â”€â”€ test_rag_service_responses.py
â”œâ”€â”€ integration/                  # çµ±åˆãƒ†ã‚¹ãƒˆ
â”‚   â””â”€â”€ test_full_flow_integration.py
â”œâ”€â”€ performance/                  # ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
â”‚   â””â”€â”€ test_performance_quality_metrics.py
â””â”€â”€ security/                     # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ
    â””â”€â”€ test_api_safety.py
```

#### å®Ÿè£…æ¸ˆã¿ãƒ†ã‚¹ãƒˆï¼ˆçµ±åˆãƒ»æ•´ç†æ¸ˆã¿ï¼‰

**ğŸ”§ ã‚µãƒ¼ãƒ“ã‚¹å±¤ãƒ†ã‚¹ãƒˆ (`services/`)**
- **åˆ†é¡çµ±åˆãƒ†ã‚¹ãƒˆ** (`test_classification_consolidated.py`): LLMã‚¯ã‚¨ãƒªåˆ†é¡ãƒ»ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆçµ±åˆç‰ˆ
- **åŸ‹ã‚è¾¼ã¿çµ±åˆãƒ†ã‚¹ãƒˆ** (`test_embedding_consolidated.py`): åŸ‹ã‚è¾¼ã¿ç”Ÿæˆãƒ»æœ€é©åŒ–ãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆçµ±åˆç‰ˆ
- **ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ¤œç´¢çµ±åˆãƒ†ã‚¹ãƒˆ** (`test_hybrid_search_consolidated.py`): çµ±åˆæ¤œç´¢ãƒ»æœ€é©åŒ–ãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆçµ±åˆç‰ˆ
- **ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢çµ±åˆãƒ†ã‚¹ãƒˆ** (`test_vector_service_consolidated.py`): ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ãƒ»æœ€é©åŒ–ãƒ†ã‚¹ãƒˆçµ±åˆç‰ˆ
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¤œç´¢ãƒ†ã‚¹ãƒˆ** (`test_database_service.py`): æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿æ¤œç´¢ã®æ­£ç¢ºæ€§ãƒ†ã‚¹ãƒˆ
- **LLMã‚µãƒ¼ãƒ“ã‚¹ãƒ†ã‚¹ãƒˆ** (`test_llm_service.py`): å¿œç­”ç”Ÿæˆãƒ»æŒ¨æ‹¶å‡¦ç†ãƒ»ä¸‹ä½äº’æ›æ€§ãƒ†ã‚¹ãƒˆ

**ğŸŒ APIå±¤ãƒ†ã‚¹ãƒˆ (`api/`)**
- **APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãƒ†ã‚¹ãƒˆ** (`test_api.py`): ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®å‹•ä½œç¢ºèª
- **APIå®‰å…¨æ€§ãƒ†ã‚¹ãƒˆ** (`test_api_safety.py`): OpenAI APIå‘¼ã³å‡ºã—é˜²ããƒ»ãƒ¢ãƒƒã‚¯ç¢ºèªãƒ»ç’°å¢ƒå¤‰æ•°ãƒ†ã‚¹ãƒˆ

**ğŸ”— çµ±åˆãƒ†ã‚¹ãƒˆ (`integration/`)**
- **ãƒ•ãƒ«ãƒ•ãƒ­ãƒ¼çµ±åˆãƒ†ã‚¹ãƒˆ** (`test_full_flow_integration.py`): å…¥åŠ›â†’åˆ†é¡â†’æ¤œç´¢â†’å¿œç­”ç”Ÿæˆã®å®Œå…¨ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆ
- **RAGã‚µãƒ¼ãƒ“ã‚¹ãƒ†ã‚¹ãƒˆ** (`test_rag_service_responses.py`): å¿œç­”ç”Ÿæˆã®å“è³ªãƒ†ã‚¹ãƒˆ

**âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ (`performance/`)**
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ»å“è³ªæ¸¬å®šãƒ†ã‚¹ãƒˆ** (`test_performance_quality_metrics.py`): ãƒ¡ãƒ¢ãƒªåŠ¹ç‡åŒ–ãƒ»å¿œç­”æ™‚é–“ãƒ»æ¤œç´¢å“è³ªãƒ»åŒæ™‚å‡¦ç†ãƒ†ã‚¹ãƒˆ

**ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ**
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å®Ÿè£…ãƒ†ã‚¹ãƒˆ** (`test_security_implementation.py`): ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å®Ÿè£…ç¢ºèª

#### ãƒ†ã‚¹ãƒˆçµæœï¼ˆæœ€æ–° - çµ±åˆãƒ»æ•´ç†å¾Œï¼‰
- **ğŸ¯ çµ±åˆãƒ†ã‚¹ãƒˆ**: **44/44 PASSED** (åˆ†é¡12 + åŸ‹ã‚è¾¼ã¿11 + ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰12 + ãƒ™ã‚¯ãƒˆãƒ«9)
- **ğŸŒ APIå±¤ãƒ†ã‚¹ãƒˆ**: **10/10 PASSED** (ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ4 + RAGå¿œç­”3 + ãƒ•ãƒ«ãƒ•ãƒ­ãƒ¼5 + APIå®‰å…¨æ€§3)
- **âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ**: **5/5 PASSED** (ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ»å“è³ªæ¸¬å®š)
- **ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ**: **8/8 PASSED** (ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å®Ÿè£…ç¢ºèª)
- **ğŸ“Š å…¨ä½“**: **67/67 PASSED** (ğŸ‰ 100%æˆåŠŸé”æˆ)

#### ãƒ†ã‚¹ãƒˆå“è³ªå‘ä¸Šã®æˆæœ
- âœ… **é‡è¤‡æ’é™¤**: è¤‡æ•°ã®é¡ä¼¼ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ©Ÿèƒ½åˆ¥ã«çµ±åˆ
- âœ… **å…±é€šåŒ–**: ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ãƒ»ãƒ¢ãƒƒã‚¯ãƒ»ãƒ˜ãƒ«ãƒ‘ãƒ¼ã®å…±é€šåŒ–ã«ã‚ˆã‚Šä¿å®ˆæ€§å‘ä¸Š
- âœ… **é«˜é€ŸåŒ–**: å®Ÿè¡Œæ™‚é–“å¤§å¹…çŸ­ç¸®ï¼ˆAPIå‘¼ã³å‡ºã—é˜²æ­¢ã«ã‚ˆã‚Š0.5ç§’ã§44ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼‰
- âœ… **å®‰å…¨æ€§**: OpenAI APIèª¤å‘¼ã³å‡ºã—é˜²æ­¢æ©Ÿèƒ½ã®å®Ÿè£…
- âœ… **æ§‹é€ åŒ–**: æ©Ÿèƒ½åˆ¥ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚ˆã‚‹ç®¡ç†ã—ã‚„ã™ã„æ§‹æˆ

#### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ
```bash
# ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ä»®æƒ³ç’°å¢ƒã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ãƒˆ
source .venv/bin/activate

# å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ ï¼ˆOpenAI APIã‚­ãƒ¼ã‚’å¤–ã—ã¦å®‰å…¨å®Ÿè¡Œï¼‰
env -u OPENAI_API_KEY pytest

# æ©Ÿèƒ½åˆ¥ãƒ†ã‚¹ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå®Ÿè¡Œ
pytest backend/app/tests/services/        # ã‚µãƒ¼ãƒ“ã‚¹å±¤ãƒ†ã‚¹ãƒˆ
pytest backend/app/tests/api/            # APIå±¤ãƒ†ã‚¹ãƒˆ
pytest backend/app/tests/integration/   # çµ±åˆãƒ†ã‚¹ãƒˆ
pytest backend/app/tests/performance/   # ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
pytest backend/app/tests/test_security_implementation.py  # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ

# çµ±åˆæ¸ˆã¿ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«å®Ÿè¡Œ
pytest backend/app/tests/services/test_*_consolidated.py

# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«å®Ÿè¡Œ
pytest backend/app/tests/services/test_hybrid_search_consolidated.py

# ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ãã§å®Ÿè¡Œ
pytest --cov=backend/app

# è©³ç´°å‡ºåŠ›ã§ã®å®Ÿè¡Œ
pytest -v --tb=short

# é«˜é€Ÿå®Ÿè¡Œï¼ˆçµ±åˆãƒ†ã‚¹ãƒˆã®ã¿ï¼‰
pytest backend/app/tests/services/test_*_consolidated.py --tb=no -q
```

#### ãƒ†ã‚¹ãƒˆé–‹ç™ºãƒ»ä¿å®ˆã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

- **æ–°ã—ã„ãƒ†ã‚¹ãƒˆè¿½åŠ æ™‚**: é©åˆ‡ãªæ©Ÿèƒ½åˆ¥ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®
- **å…±é€šãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£**: `conftest.py` ã¾ãŸã¯ `fixtures/` ã‚’æ´»ç”¨
- **APIå®‰å…¨æ€§**: å¿…ãšOpenAI APIã‚­ãƒ¼ãªã—ã§ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- **çµ±åˆãƒ†ã‚¹ãƒˆå„ªå…ˆ**: å€‹åˆ¥ãƒ†ã‚¹ãƒˆã‚ˆã‚Šçµ±åˆãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’å„ªå…ˆä½¿ç”¨
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹é‡è¦–**: ãƒ†ã‚¹ãƒˆå®Ÿè¡Œé€Ÿåº¦ã‚’æ„è­˜ã—ãŸè¨­è¨ˆ

---

## ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆï¼ˆSphinxï¼‰

### æ¦‚è¦
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ [Sphinx](https://www.sphinx-doc.org/) ã‚’ä½¿ç”¨ã—ã¦è‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™ã€‚
è©³ç´°ãªdocstringã‹ã‚‰ç¾ã—ã„HTMLãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ç”Ÿæˆã§ãã¾ã™ã€‚

### ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
```bash
# ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆã«å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install sphinx sphinx-rtd-theme myst-parser sphinx-autobuild

# ã¾ãŸã¯ã€backend/requirements.txtã«å«ã¾ã‚Œã¦ã„ã‚‹å ´åˆ
pip install -r backend/requirements.txt
```

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ç”Ÿæˆ
```bash
# ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•
cd docs/sphinx

# HTMLãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ç”Ÿæˆ
make html

# ã¾ãŸã¯ã€ç›´æ¥Sphinxã‚’å®Ÿè¡Œ
sphinx-build -b html . _build/html
```

### ç”Ÿæˆã•ã‚ŒãŸãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ç¢ºèª
```bash
# ç”Ÿæˆã•ã‚ŒãŸãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’é–‹ã
open _build/html/index.html  # macOS
start _build/html/index.html  # Windows
```

### ãƒ©ã‚¤ãƒ–ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆé–‹ç™ºæ™‚ï¼‰
```bash
# è‡ªå‹•æ›´æ–°ä»˜ãã§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
make livehtml

# ã¾ãŸã¯sphinx-autobuildã‚’ç›´æ¥å®Ÿè¡Œ
sphinx-autobuild . _build/html
```

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ§‹æˆ
- **`docs/sphinx/index.rst`**: ãƒ¡ã‚¤ãƒ³ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- **`docs/sphinx/services/`**: ã‚µãƒ¼ãƒ“ã‚¹å±¤ã®APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- **`docs/sphinx/conf.py`**: Sphinxè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
- **`docs/sphinx/Makefile`**: ãƒ“ãƒ«ãƒ‰ç”¨Makefile

### docstringè¨˜è¿°ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ä»¥ä¸‹ã®å½¢å¼ã§docstringã‚’è¨˜è¿°ã—ã¾ã™ï¼š

```python
def example_method(self, param1: str, param2: int) -> Dict[str, Any]:
    """
    ãƒ¡ã‚½ãƒƒãƒ‰ã®æ¦‚è¦èª¬æ˜ã€‚
    
    è©³ç´°ãªèª¬æ˜ã€‚è¤‡æ•°è¡Œã«ã‚ãŸã£ã¦æ©Ÿèƒ½ã‚„ä½¿ç”¨å ´é¢ã‚’èª¬æ˜ã—ã¾ã™ã€‚
    
    Args:
        param1: ç¬¬ä¸€å¼•æ•°ã®èª¬æ˜
            - è©³ç´°ãªèª¬æ˜ã‚„åˆ¶ç´„
        param2: ç¬¬äºŒå¼•æ•°ã®èª¬æ˜
            
    Returns:
        æˆ»ã‚Šå€¤ã®èª¬æ˜:
        - key1: å€¤1ã®èª¬æ˜
        - key2: å€¤2ã®èª¬æ˜
        
    Raises:
        CustomException: ä¾‹å¤–ãŒç™ºç”Ÿã™ã‚‹æ¡ä»¶
        ValueError: ä¸æ­£ãªå€¤ãŒæ¸¡ã•ã‚ŒãŸå ´åˆ
        
    Examples:
        >>> service = ExampleService()
        >>> result = service.example_method("test", 42)
        >>> print(result["key1"])
        expected_value
        
    Note:
        è¿½åŠ ã®æ³¨æ„äº‹é …ã‚„å®Ÿè£…è©³ç´°
    """
```

---

## Gitãƒ–ãƒ©ãƒ³ãƒå‘½åãƒ«ãƒ¼ãƒ«

`<ã‚¿ã‚¤ãƒ—>/<å¤‰æ›´å†…å®¹>-<issueç•ªå·ï¼ˆä»»æ„ï¼‰>`

### ã‚¿ã‚¤ãƒ—ã®ç¨®é¡ï¼š

- `feature`ï¼šæ–°æ©Ÿèƒ½ã®è¿½åŠ 
- `fix`ï¼šãƒã‚°ä¿®æ­£
- `refactor`ï¼šãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ï¼ˆæŒ™å‹•ã‚’å¤‰ãˆãªã„æ”¹å–„ï¼‰
- `chore`ï¼šè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚„READMEã®æ›´æ–°ãªã©
- `test`ï¼šãƒ†ã‚¹ãƒˆã®è¿½åŠ ãƒ»ä¿®æ­£

---

## .gitignoreï¼ˆæ¨å¥¨ï¼‰

```
# .env files
.env
.env.local
.env.*.local

# Pythonä»®æƒ³ç’°å¢ƒ
.venv/

# Node modules
node_modules/

# Build output / cache
.next/
dist/
frontend/dist/
backend/dist/
coverage/

# Sphinx documentation
docs/sphinx/_build/
docs/sphinx/_static/
docs/sphinx/_templates/

# Log files
*.log
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# Editor/IDE settings
.vscode/
.idea/

# OS files
.DS_Store
Thumbs.db

# ãƒ‡ãƒ¼ã‚¿ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆã‚µãƒ³ãƒ—ãƒ«ã‚„ç”Ÿæˆãƒ‡ãƒ¼ã‚¿ï¼‰
data/
```

---

## æ³¨æ„äº‹é …

- OpenAI APIã‚­ãƒ¼ãªã©ã®æ©Ÿå¯†æƒ…å ±ã¯**çµ¶å¯¾ã«å…¬é–‹ã—ãªã„ã§ãã ã•ã„**ã€‚
- `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã¯ `.gitignore` ã§ç®¡ç†ã•ã‚Œã¦ã„ã¾ã™ã€‚

---

## ä½œè€…

MASAKI

---

## ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ

### ğŸš€ æœ¬ç•ªç’°å¢ƒï¼ˆGoogle Cloud Runï¼‰

#### âœ… ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†æ¸ˆã¿ï¼ˆ2025å¹´6æœˆ16æ—¥ï¼‰

**ç¾åœ¨ã®ãƒ‡ãƒ—ãƒ­ã‚¤æ¸ˆã¿ç’°å¢ƒæƒ…å ±**
- **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆID**: `gamechat-ai`
- **ã‚µãƒ¼ãƒ“ã‚¹å**: `gamechat-ai-backend`
- **ãƒªãƒ¼ã‚¸ãƒ§ãƒ³**: `asia-northeast1`ï¼ˆæ±äº¬ï¼‰
- **ã‚µãƒ¼ãƒ“ã‚¹URL**: `https://gamechat-ai-backend-905497046775.asia-northeast1.run.app`
- **ã‚¹ãƒšãƒƒã‚¯**: CPU 1ã‚³ã‚¢ã€ãƒ¡ãƒ¢ãƒª 1GBã€è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ï¼ˆ0-10ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ï¼‰

**ç¨¼åƒä¸­ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**
- **ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯**: `/health` âœ… æ­£å¸¸ç¨¼åƒä¸­
- **API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: `/docs`
- **ReDoc**: `/redoc`
- **ãƒãƒ£ãƒƒãƒˆAPI**: `/api/v1/chat`
- **RAG API**: `/api/v1/rag/chat`

**ãƒ‡ãƒ—ãƒ­ã‚¤æ§‹æˆ**
- **Docker ã‚¤ãƒ¡ãƒ¼ã‚¸**: `asia-northeast1-docker.pkg.dev/gamechat-ai/gamechat-ai-backend/backend`
- **ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ **: linux/amd64
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: HTTPSè‡ªå‹•é©ç”¨ã€CORSè¨­å®šæ¸ˆã¿
- **ç›£è¦–**: ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã€æ§‹é€ åŒ–ãƒ­ã‚°ã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†
**ç¨¼åƒä¸­ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**
- **ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯**: `/health` âœ… æ­£å¸¸ç¨¼åƒä¸­
- **API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: `/docs`
- **ReDoc**: `/redoc`
- **ãƒãƒ£ãƒƒãƒˆAPI**: `/api/v1/chat`
- **RAG API**: `/api/v1/rag/chat`
#### ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †ï¼ˆæ›´æ–°æ™‚ï¼‰

**è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆæ¨å¥¨ï¼‰**
```bash
# è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½¿ç”¨
./scripts/cloud-run-deploy.sh
```

**æ‰‹å‹•ãƒ‡ãƒ—ãƒ­ã‚¤**

**1. ç’°å¢ƒæº–å‚™**
```bash
# Google Cloud CLIèªè¨¼ç¢ºèª
gcloud auth list
gcloud config set project gamechat-ai

# Dockerèªè¨¼è¨­å®š
gcloud auth configure-docker asia-northeast1-docker.pkg.dev
```

**2. ã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ—ãƒƒã‚·ãƒ¥**
```bash
# Cloud Runå¯¾å¿œã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰
docker build --platform linux/amd64 -f backend/Dockerfile -t "asia-northeast1-docker.pkg.dev/gamechat-ai/gamechat-ai-backend/backend" .

# Artifact Registry ã«ãƒ—ãƒƒã‚·ãƒ¥
docker push asia-northeast1-docker.pkg.dev/gamechat-ai/gamechat-ai-backend/backend:latest
```

**3. Cloud Run ãƒ‡ãƒ—ãƒ­ã‚¤**
```bash
gcloud run deploy gamechat-ai-backend \
  --image asia-northeast1-docker.pkg.dev/gamechat-ai/gamechat-ai-backend/backend:latest \
  --platform managed \
  --region asia-northeast1 \
  --allow-unauthenticated \
  --port 8000 \
  --memory 1Gi \
  --cpu 1 \
  --min-instances 0 \
  --max-instances 10 \
  --timeout 300 \
  --set-env-vars="ENVIRONMENT=production,LOG_LEVEL=INFO"
```

### ğŸ“¦ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆDocker ã‚¤ãƒ¡ãƒ¼ã‚¸æº–å‚™æ¸ˆã¿ï¼‰

#### âš ï¸ æ—§ç’°å¢ƒã®Docker ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼ˆä½¿ç”¨åœæ­¢ï¼‰

**ç¾åœ¨ã®ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤ç’°å¢ƒ**
- **ç¾åœ¨**: Artifact Registryä½¿ç”¨ï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã¿ï¼‰ã€çµ±ä¸€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ `gamechat-ai` ã§é‹ç”¨

**Firebase Hosting é‹ç”¨ä¸­**
- Firebase Hostingã‚µã‚¤ãƒˆè¨­å®šå®Œäº†
- é™çš„ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå¯¾å¿œæ¸ˆã¿
- Cloud Run ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¨ã®é€£æºè¨­å®šæ¸ˆã¿

---

### ğŸŒ Firebase Hostingï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰

#### âœ… Firebase Hosting ç§»è¡Œæº–å‚™å®Œäº†ï¼ˆ2025å¹´6æœˆ16æ—¥ï¼‰

**Firebase Hostingè¨­å®š**
- **é™çš„ã‚µã‚¤ãƒˆç”Ÿæˆ**: Next.js exportæ©Ÿèƒ½ä½¿ç”¨
- **Cloud Runé€£æº**: API ãƒªã‚¯ã‚¨ã‚¹ãƒˆè‡ªå‹•ãƒ—ãƒ­ã‚­ã‚·
- **ã‚°ãƒ­ãƒ¼ãƒãƒ«CDN**: ä¸–ç•Œä¸­ã§é«˜é€Ÿé…ä¿¡
- **è‡ªå‹•HTTPS**: SSLè¨¼æ˜æ›¸è‡ªå‹•ç®¡ç†

**ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †**
```bash
# 1. Firebase CLIèªè¨¼ï¼ˆåˆå›ã®ã¿ï¼‰
firebase login

# 2. Firebaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–ï¼ˆåˆå›ã®ã¿ï¼‰
firebase init hosting

# 3. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ“ãƒ«ãƒ‰ & ãƒ‡ãƒ—ãƒ­ã‚¤
./scripts/firebase-deploy.sh

# 4. Firebase Hosting URLç¢ºèª
firebase hosting:sites:list
```

**ç’°å¢ƒè¨­å®š**
```bash
# frontend/.env.firebase ã‚’ä½œæˆãƒ»ç·¨é›†
cp frontend/.env.firebase.example frontend/.env.firebase
```

**ä¸»ãªåˆ©ç‚¹**
- ğŸ“ˆ **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: ã‚°ãƒ­ãƒ¼ãƒãƒ«CDNã«ã‚ˆã‚‹é«˜é€Ÿé…ä¿¡
- ğŸ”’ **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: è‡ªå‹•HTTPSãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼
- ğŸ’° **ã‚³ã‚¹ãƒˆåŠ¹ç‡**: é™çš„ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã§ä½ã‚³ã‚¹ãƒˆ
- ğŸ›  **é‹ç”¨æ€§**: è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ»ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½

---

## ğŸ“Š ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆçµ±è¨ˆ

### ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†çŠ¶æ³ï¼ˆ2025å¹´6æœˆ15æ—¥ç¾åœ¨ï¼‰

| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | çŠ¶æ³ | ãƒ‡ãƒ—ãƒ­ã‚¤å…ˆ | URL |
|---------------|------|-----------|-----|
| **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ API** | âœ… ç¨¼åƒä¸­ | Google Cloud Run | https://gamechat-ai-backend-507618950161.asia-northeast1.run.app |
| **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰** | ï¿½ ç§»è¡Œæº–å‚™å®Œäº† | Firebase Hosting | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®šå¾Œã«ç¢ºå®š |
| **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹** | âœ… ç¨¼åƒä¸­ | Upstash Vector | æœ¬ç•ªç’°å¢ƒãƒ‡ãƒ¼ã‚¿æº–å‚™æ¸ˆã¿ |
| **ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ ** | ğŸ”§ è¨­å®šæ¸ˆã¿ | Cloud Monitoring | ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãƒ»ãƒ­ã‚°åé›†ä¸­ |

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™

| é …ç›® | å€¤ | å‚™è€ƒ |
|------|----|----- |
| **API å¿œç­”æ™‚é–“** | å¹³å‡ 1.8ç§’ | æŒ¨æ‹¶æ¤œå‡ºæœ€é©åŒ–æ¸ˆã¿ï¼ˆ87%çŸ­ç¸®ï¼‰ |
| **Docker ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚µã‚¤ã‚º** | Backend: 532MB, Frontend: 309MB | Alpine Linux è»½é‡åŒ–æ¸ˆã¿ |
| **ãƒ“ãƒ«ãƒ‰æ™‚é–“** | Backend: ~1.5ç§’, Frontend: ~3.7ç§’ | ã‚­ãƒ£ãƒƒã‚·ãƒ¥æœ€é©åŒ–æ¸ˆã¿ |
| **ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡** | æœ¬ç•ª: 1GB, é–‹ç™º: 512MB | ãƒªã‚½ãƒ¼ã‚¹åŠ¹ç‡åŒ–æ¸ˆã¿ |

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾å¿œ

- âœ… **HTTPS**: Cloud Runè‡ªå‹•SSLé©ç”¨
- âœ… **CORS**: æœ¬ç•ªãƒ‰ãƒ¡ã‚¤ãƒ³åˆ¶é™è¨­å®šæ¸ˆã¿  
- âœ… **èªè¨¼**: API ã‚­ãƒ¼ç®¡ç†ãƒ»ç’°å¢ƒå¤‰æ•°åˆ†é›¢
- âœ… **ã‚³ãƒ³ãƒ†ãƒŠ**: érootãƒ¦ãƒ¼ã‚¶ãƒ¼å®Ÿè¡Œ
- âœ… **ãƒ­ã‚°**: æ§‹é€ åŒ–ãƒ­ã‚°ãƒ»ç›£è¦–é€£æº

### ä»Šå¾Œã®äºˆå®š

- ğŸ”„ Firebase Hosting ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤
- ğŸ”„ CDNè¨­å®šã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
- ğŸ”„ ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šå®Œæˆ
- ğŸ”„ è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ´»ç”¨

---

## ğŸš€ CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

### å®Œå…¨è‡ªå‹•åŒ–ã•ã‚ŒãŸCI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

GameChat AIã¯åŒ…æ‹¬çš„ãªCI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«ã‚ˆã‚Šã€å“è³ªã¨ä¿¡é ¼æ€§ã‚’ç¢ºä¿ã—ã¦ã„ã¾ã™ã€‚

#### ğŸ”„ ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ§‹æˆ

##### 1. è‡ªå‹•ãƒ†ã‚¹ãƒˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
- **ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ**: pytestï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼‰ã€Vitestï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰
- **ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ**: ã‚µãƒ¼ãƒ“ã‚¹é–“é€£æºãƒ†ã‚¹ãƒˆ
- **ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ**: Playwrightä½¿ç”¨
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ**: è² è·ãƒ†ã‚¹ãƒˆã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“æ¸¬å®š
- **ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸**: 85%ä»¥ä¸Šã‚’ç¶­æŒ

##### 2. ãƒ–ãƒ«ãƒ¼ã‚°ãƒªãƒ¼ãƒ³ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ
- **ã‚¼ãƒ­ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ **: ã‚µãƒ¼ãƒ“ã‚¹ç¶™ç¶šã—ãªãŒã‚‰ãƒ‡ãƒ—ãƒ­ã‚¤
- **æ®µéšçš„ãƒªãƒªãƒ¼ã‚¹**: ã‚«ãƒŠãƒªã‚¢ãƒªãƒªãƒ¼ã‚¹ï¼ˆ5%â†’100%ï¼‰
- **è‡ªå‹•å¥å…¨æ€§ãƒã‚§ãƒƒã‚¯**: ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã®è‡ªå‹•æ¤œè¨¼
- **å³åº§ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯**: å•é¡Œæ¤œå‡ºæ™‚ã®è‡ªå‹•åˆ‡ã‚Šæˆ»ã—

##### 3. è‡ªå‹•ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½
- **ç›£è¦–ãƒ™ãƒ¼ã‚¹**: ã‚¨ãƒ©ãƒ¼ç‡ãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–
- **ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯**: æ‰‹å‹•ã§ã®å³åº§å¾©æ—§
- **æ®µéšçš„ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯**: ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯èª¿æ•´ã«ã‚ˆã‚‹å®‰å…¨ãªå¾©æ—§
- **è¨­å®šå·»ãæˆ»ã—**: ç’°å¢ƒå¤‰æ•°ãƒ»è¨­å®šã®è‡ªå‹•å¾©å…ƒ

##### 4. æ‰¿èªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
- **å¤‰æ›´å½±éŸ¿åˆ†æ**: ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ã®è‡ªå‹•å½±éŸ¿åº¦åˆ¤å®š
- **æ®µéšçš„æ‰¿èª**: å½±éŸ¿åº¦ã«å¿œã˜ãŸå¿…è¦æ‰¿èªè€…æ•°èª¿æ•´
- **ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°æ¤œè¨¼**: æœ¬ç•ªå‰ã®å¿…é ˆæ¤œè¨¼ç’°å¢ƒ
- **å¤‰æ›´ç®¡ç†**: ãƒ‡ãƒ—ãƒ­ã‚¤å±¥æ­´ã¨ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£

#### ğŸ“Š ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ç›£è¦–

##### ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–
- **ãƒ‡ãƒ—ãƒ­ã‚¤æˆåŠŸç‡**: 95%ä»¥ä¸Šã‚’ç¶­æŒ
- **ãƒ†ã‚¹ãƒˆæˆåŠŸç‡**: 98%ä»¥ä¸Šã‚’ç¶­æŒ
- **å¹³å‡ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚é–“**: 15åˆ†ä»¥å†…
- **ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ™‚é–“**: 5åˆ†ä»¥å†…

##### é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æ
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è„†å¼±æ€§ãƒ¬ãƒãƒ¼ãƒˆ
- ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸çµ±è¨ˆ
- æ”¹å–„æ¨å¥¨äº‹é …

#### ğŸ›¡ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£çµ±åˆ

##### è‡ªå‹•ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯
- **ä¾å­˜é–¢ä¿‚ã‚¹ã‚­ãƒ£ãƒ³**: Safetyã€npm audit
- **ã‚³ãƒ¼ãƒ‰è„†å¼±æ€§**: Trivyã€CodeQL
- **ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆæ¤œå‡º**: GitLeaks
- **è¨­å®šæ¤œè¨¼**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

##### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼
- ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆå¿…é ˆæ‰¿èª
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¤‰æ›´ã®è¿½åŠ ãƒ¬ãƒ“ãƒ¥ãƒ¼
- æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤ã®æ‰¿èªã‚²ãƒ¼ãƒˆ
- ç›£æŸ»ãƒ­ã‚°è¨˜éŒ²

#### ğŸ”§ é–‹ç™ºè€…ä½“é¨“

##### é«˜é€Ÿãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
- **ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**: 5åˆ†ä»¥å†…ã®åˆæœŸãƒã‚§ãƒƒã‚¯
- **ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆ**: å³åº§ã®æ¤œè¨¼å¯èƒ½
- **ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°**: æœ¬ç•ªåŒç­‰ç’°å¢ƒã§ã®æ¤œè¨¼
- **è‡ªå‹•é€šçŸ¥**: Slack/ãƒ¡ãƒ¼ãƒ«çµ±åˆ

##### ãƒ‡ãƒãƒƒã‚°æ”¯æ´
- è©³ç´°ãªã‚¨ãƒ©ãƒ¼ãƒ¬ãƒãƒ¼ãƒˆ
- ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆä¿å­˜ï¼ˆ90æ—¥é–“ï¼‰
- ãƒ­ã‚°é›†ç´„ã¨ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚°
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æ

#### ğŸ¯ å“è³ªãƒ¡ãƒˆãƒªã‚¯ã‚¹

##### ç¾åœ¨ã®é”æˆçŠ¶æ³
- âœ… **ãƒ‡ãƒ—ãƒ­ã‚¤æˆåŠŸç‡**: 96%
- âœ… **ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸**: 87%ï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼‰ã€82%ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰
- âœ… **å¹³å‡å¾©æ—§æ™‚é–“**: 3åˆ†
- âœ… **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è„†å¼±æ€§**: 0ä»¶ï¼ˆç¶™ç¶šï¼‰

##### ç›®æ¨™æŒ‡æ¨™
- **Lead Time**: ã‚³ãƒŸãƒƒãƒˆã‹ã‚‰æœ¬ç•ªåæ˜ ã¾ã§30åˆ†ä»¥å†…
- **Deployment Frequency**: é€±5å›ä»¥ä¸Š
- **Mean Time to Recovery**: 5åˆ†ä»¥å†…
- **Change Failure Rate**: 5%ä»¥ä¸‹

#### ğŸš€ ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œ

```bash
# è‡ªå‹•ãƒ†ã‚¹ãƒˆï¼ˆãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ï¼‰
git push origin feature-branch

# ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ãƒ‡ãƒ—ãƒ­ã‚¤
gh workflow run deployment-approval.yml \
  -f deployment_environment=staging \
  -f change_type=feature

# æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆæ‰¿èªå¾Œï¼‰
gh workflow run blue-green-deployment.yml \
  -f deployment_type=blue-green \
  -f target_environment=production

# ç·Šæ€¥ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯
gh workflow run automatic-rollback.yml \
  -f rollback_reason=high-error-rate \
  -f immediate_rollback=true
```

#### ğŸ“‹ é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚¬ã‚¤ãƒ‰](docs/deployment/deployment-guide.md)
- [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼](docs/security/README.md)
- [ç›£è¦–ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š](docs/deployment/monitoring.md)
- [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](docs/deployment/troubleshooting.md)

---